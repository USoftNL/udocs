"use strict";(self.webpackChunkudocs=self.webpackChunkudocs||[]).push([[7069],{20014:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>c,frontMatter:()=>r,metadata:()=>t,toc:()=>u});const t=JSON.parse('{"id":"Modeller_and_Rules_Engine/Domains/Unique_values","title":"Unique values","description":"You can specify that a domain must generate unique values. You can only have generated unique values for primary key columns.","source":"@site/docs/Modeller_and_Rules_Engine/Domains/Unique_values.md","sourceDirName":"Modeller_and_Rules_Engine/Domains","slug":"/Modeller_and_Rules_Engine/Domains/Unique_values","permalink":"/udocs/Modeller_and_Rules_Engine/Domains/Unique_values","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"Unique_values"},"sidebar":"sidebar","previous":{"title":"Patterns (Regular Expressions)","permalink":"/udocs/Modeller_and_Rules_Engine/Domains/Patterns_Regular_Expressions"},"next":{"title":"Allowed values","permalink":"/udocs/Modeller_and_Rules_Engine/Domains/Allowed_values"}}');var i=a(74848),s=a(28453);const r={id:"Unique_values"},l="Unique values",o={},u=[{value:"Sequence Definitions (Oracle &amp; SQL Server Only)",id:"sequence-definitions-oracle--sql-server-only",level:2},{value:"Unique values: the concept",id:"unique-values-the-concept",level:2},{value:"Are unique values updatable?",id:"are-unique-values-updatable",level:2},{value:"Unique values and indexes",id:"unique-values-and-indexes",level:2},{value:"Unique values generates as GUIDs",id:"unique-values-generates-as-guids",level:2},{value:"Unique values generated by an external component",id:"unique-values-generated-by-an-external-component",level:2},{value:"Getting the last generated unique value",id:"getting-the-last-generated-unique-value",level:2},{value:"Getting the last generated GUID",id:"getting-the-last-generated-guid",level:2}];function d(e){const n={admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"unique-values",children:"Unique values"})}),"\n",(0,i.jsxs)(n.p,{children:["You can specify that a domain must ",(0,i.jsx)(n.strong,{children:"generate unique values"}),". You can only have generated unique values for ",(0,i.jsx)(n.strong,{children:"primary key"})," columns."]}),"\n",(0,i.jsx)(n.p,{children:"When you have unique values generated, in each column based on the domain, for each new record, the application will automatically generate a value that is unique for that record in that column."}),"\n",(0,i.jsx)(n.p,{children:"The default for the Generate Unique Values domain attribute is No."}),"\n",(0,i.jsx)(n.p,{children:"If you set Generate Unique Values = Database:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"On Oracle or SQL Server, numerical unique values are generated by a database sequence. This also applies if you access these database platforms via ODBC or JDBC."}),"\n",(0,i.jsx)(n.li,{children:"On certain platforms (Derby, PostgreSQL), unique values are generated by a USoft sequence."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"sequence-definitions-oracle--sql-server-only",children:"Sequence Definitions (Oracle & SQL Server Only)"}),"\n",(0,i.jsx)(n.p,{children:"On Oracle and SQL Server, you can set 7 additional attributes to control exactly how a database sequence for a column based on the domain should behave:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"Attribute"})}),(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"Meaning"})})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Increment By"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)("p",{children:"The integer value by which the next sequence value must be higher than the previous."}),(0,i.jsx)("p",{children:"The default is 1."})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Start With"}),(0,i.jsx)(n.td,{children:"The integer value of the first generated sequence number."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Min. Value"}),(0,i.jsx)(n.td,{children:"The minimum value that the sequence is allowed to generate."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Max. Value"}),(0,i.jsx)(n.td,{children:"The maximum value that the sequence is allowed to generate."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Cycle"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)("p",{children:"If you set Cycle = Yes, the Min. Value is generated as the next value when the Max. Value is reached."}),(0,i.jsx)("p",{children:"The default is No."}),"> [!WARNING]"]})]})]})]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Cycle is supported only for single-column primary keys."}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["|\n|Order (Oracle only)|",(0,i.jsx)("p",{children:"If you set Order = Yes, sequence numbers are generated in order of request."}),(0,i.jsx)("p",{children:"This has an effect only if you are using Oracle with Real Application Clusters; if you are using exclusive mode, sequence numbers are always generated in order. Setting Order = Yes is usually not important for sequences used to generate primary keys. It may be useful if you are using sequence numbers as timestamps."}),"|\n|Cache   |",(0,i.jsx)("p",{children:"The number of sequence numbers pre-allocated and kept in memory for faster generation."}),(0,i.jsx)("p",{children:"Set Cache = 0 if you do not want sequence numbers cached."}),(0,i.jsx)("p",{children:"The default is 20."}),"|"]}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsx)(n.p,{children:'Only "Increment By\u201d, "Start With\u201d and "Max. Value\u201d are heeded when the column based on the domain is part of a composite primary key.'})}),"\n",(0,i.jsx)(n.h2,{id:"unique-values-the-concept",children:"Unique values: the concept"}),"\n",(0,i.jsx)(n.p,{children:"Generated unique values are meaningless key values that act as a handle for recognising each individual record. This is why you can have generated unique values only for primary key columns."}),"\n",(0,i.jsx)(n.p,{children:"In a USoft Relationship, you must use the same domain for the primary key column(s) and for the foreign key column(s) that refer to it (them). If the primary key has generated unique values, these will be unique across the parent table. However, corresponding foreign key values in the child table will typically NOT be unique across the child table."}),"\n",(0,i.jsx)(n.p,{children:"If a column based on a domain with generated unique values is PART of a primary key, in other words, if it is one of the columns of a multi-column primary key, then unique values will be generated accordingly. In this case, it is the multi-column value combination that will be unique, not (or not typically) the individual column values."}),"\n",(0,i.jsx)(n.h2,{id:"are-unique-values-updatable",children:"Are unique values updatable?"}),"\n",(0,i.jsx)(n.p,{children:"Generated unique values in primary keys are system-generated, not user-defined. What you normally want is that interactive users can query these values, but are not allowed to enter or change these values."}),"\n",(0,i.jsx)(n.p,{children:"In USoft default web pages, screen fields corresponding to these values are query-only. Interactive users cannot insert or update values in these fields."}),"\n",(0,i.jsxs)(n.p,{children:["If you import data using ",(0,i.jsx)(n.strong,{children:"XML.Import"})," or related techniques, you can supply external unique values. These values will be correctly imported and not overwritten by sequence-generated values, on condition that they lead to a situation where each record has a unique value (otherwise, it's an error)."]}),"\n",(0,i.jsx)(n.h2,{id:"unique-values-and-indexes",children:"Unique values and indexes"}),"\n",(0,i.jsx)(n.p,{children:"The Generate Unique Value domain attribute allows unique values to be generated, but uniqueness of values in a column is ultimately checked not by this attribute but by unique indexes."}),"\n",(0,i.jsx)(n.p,{children:"USoft Definer automatically creates a unique index for each primary key that you define. In addition, you can manually add additional indexes for which you set Unique = Yes."}),"\n",(0,i.jsx)(n.p,{children:"\xa0\xa0\xa0 Unique values generated by an Oracle or Sql Server sequence"}),"\n",(0,i.jsx)(n.p,{children:"On Oracle or SQL Server, for columns based on a given domain, to have unique values generated by a database sequence:"}),"\n",(0,i.jsx)(n.p,{children:"1.\xa0\xa0 \xa0Open the Domains window for the domain for which you want unique value generation.\n2.\xa0\xa0 \xa0Set Generate Unique Values = Database."}),"\n",(0,i.jsx)(n.p,{children:"By default, sequence numbers start with 1, and increment by 1. On Oracle or SQL Server, however, you may change these settings:"}),"\n",(0,i.jsx)(n.p,{children:'3.\xa0\xa0 \xa0In the "Sequence Definitions (Oracle & Sql Server only)" box, specify the increment, the starting value, the maximum and minimum values, and the cycle, cache, and order values.\n4.\xa0\xa0 \xa0Save work.'}),"\n",(0,i.jsx)(n.p,{children:"\xa0\xa0\xa0 Unique values generated by a USoft sequence"}),"\n",(0,i.jsx)(n.p,{children:"On ODBC, JDBC or Derby, for columns based on a given domain, to have unique values generated by a USoft sequence:"}),"\n",(0,i.jsx)(n.p,{children:"1.\xa0\xa0 \xa0Open the Domains window for the domain for which you want unique value generation.\n2.\xa0\xa0 \xa0Set Generate Unique Values = Database.\n3.\xa0\xa0 \xa0Save work."}),"\n",(0,i.jsx)(n.p,{children:"USoft simulates a database sequence by keeping track of unique numbers in the TABLE_SEQUENCE_NUMBERS system table."}),"\n",(0,i.jsx)(n.h2,{id:"unique-values-generates-as-guids",children:"Unique values generates as GUIDs"}),"\n",(0,i.jsx)(n.p,{children:"You can have unique values by having USoft generate a random or GUID value of the following type:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"dd934d9119b445d192d30f0c26afb5fc\n"})}),"\n",(0,i.jsx)(n.p,{children:"To have generated GUIDs:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"In the Domains window, create a Domain D with Generate Unique Values = GUID."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Now, each time you base a column on domain D, USoft will generate a GUID value for that column in each new runtime record. A typical application of GUIDs is for primary key columns."}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["You can get the last generated GUID programmatically. See the last section in this article.\nYou can also ",(0,i.jsx)(n.em,{children:"produce"})," GUIDs programmatically. Call the GUID() SQL function."]})}),"\n",(0,i.jsx)(n.h2,{id:"unique-values-generated-by-an-external-component",children:"Unique values generated by an external component"}),"\n",(0,i.jsx)(n.p,{children:"\xa0You can have unique values generated by an RDMI component that you write yourself and declare in USoft Definer. The advantage is that you can determine all the details of unique value generation yourself. The disadvantage is that this option requires more work, especially to maintain the solution in the long run."}),"\n",(0,i.jsx)(n.p,{children:'For each primary key column based on the domain, your component needs to have a separate method called "<Table Name>GETSEQUENCENUMBER", for example: "PERSONGETSEQUENCENUMBER". The corresponding implementation, eg., "PersonGetSequenceNumber()", must executed the desired behavior.'}),"\n",(0,i.jsx)(n.p,{children:"To have unique values generated by an RDMI component:"}),"\n",(0,i.jsx)(n.p,{children:"1.\xa0\xa0 \xa0Make a first implementation of the component and declare the component in the RDMI Components window or tab.\n2.\xa0\xa0 \xa0In the Domains window, create a Domain D with Generate Unique Values = Component.\n3.\xa0\xa0\xa0 In the dropdown box immediately to the right of the Generate Unique Values field, using the small lookup button to its right, identify the component that you want to use.\nNow, each time you base a primary key column on domain D, a <TableName>GETSEQUENCENUMBER method is added to the component definition. Parameters are added for the other primary key columns.\n4.\xa0\xa0 \xa0(Re-)write the <TableName>GetSequenceNumber() method in the component code, and let this method provide the sequence value. This method is invoked when inserting a record."}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsx)(n.p,{children:"You can have a component generate the unique values for the primary key of a database table, but also for the primary key of a component table."})}),"\n",(0,i.jsx)(n.p,{children:"\xa0"}),"\n",(0,i.jsx)(n.h2,{id:"getting-the-last-generated-unique-value",children:"Getting the last generated unique value"}),"\n",(0,i.jsx)(n.p,{children:'If a table contains a key column for which the domain has the "Generate Unique Values = Database" setting, each time a new row is INSERTed into this table, the Rules Engine automatically generates a new unique value for that key column.'}),"\n",(0,i.jsx)(n.p,{children:'If you are in client/server mode, you can see this new value directly after INSERTing the row. This behaviour is referred to as "update-notify".'}),"\n",(0,i.jsx)(n.p,{children:'But if you are using the Remote Rules Service API or the Rules Service, the underlying protocol (ODBC or JDBC) which allows you to communicate with the Rules Engine does not provide an "update-notify" mechanism, so that you cannot see the newly generated key value. This makes it difficult to retrieve the row that you have just inserted.'}),"\n",(0,i.jsx)(n.p,{children:"To get around this problem, USoft provides a simple mechanism. The Rules Engine keeps the last unique value it has generated, and this value can be retrieved by the statement:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"INVOKE RulesEngine.getLastGeneratedUniqueValue\n"})}),"\n",(0,i.jsx)(n.p,{children:"You can also use function call syntax:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"SELECT RulesEngine.getLastGeneratedUniqueValue()\n"})}),"\n",(0,i.jsx)(n.p,{children:"\xa0"}),"\n",(0,i.jsx)(n.p,{children:"The Rules Engine only retains the generated value of the LAST USER-DEFINED record. It does not heed INSERTs performed by non-interactive constraint action."}),"\n",(0,i.jsx)(n.h2,{id:"getting-the-last-generated-guid",children:"Getting the last generated GUID"}),"\n",(0,i.jsx)(n.p,{children:'If a table contains a key column for which the domain has the "Generate Unique Values = GUID" setting, each time a new row is INSERTed into this table, the Rules Engine automatically generates a GUID for that key column.'}),"\n",(0,i.jsx)(n.p,{children:"The Rules Engine keeps the last GUID value it has generated. This value can be retrieved by the statement:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"INVOKE RulesEngine.getLastGeneratedGUID\n"})}),"\n",(0,i.jsx)(n.p,{children:"You can also use function call syntax:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"SELECT RulesEngine.getLastGeneratedGUID()\n"})}),"\n",(0,i.jsx)(n.p,{children:"The Rules Engine only retains the generated value of the LAST USER-DEFINED record. It does not heed INSERTs performed by non-interactive constraint action."})]})}function c(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453:(e,n,a)=>{a.d(n,{R:()=>r,x:()=>l});var t=a(96540);const i={},s=t.createContext(i);function r(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);