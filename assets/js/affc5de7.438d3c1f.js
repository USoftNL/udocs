"use strict";(self.webpackChunkudocs=self.webpackChunkudocs||[]).push([[77920],{28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>o});var i=t(96540);const s={},a=i.createContext(s);function r(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(a.Provider,{value:n},e.children)}},58158:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>m,frontMatter:()=>r,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"Repositories/Blend_directives/pcWinCommand","title":"pc:WinCommand","description":"This article is about the pc:WinCommand Blend directive.","source":"@site/docs/Repositories/Blend_directives/pcWinCommand.md","sourceDirName":"Repositories/Blend_directives","slug":"/Repositories/Blend_directives/pcWinCommand","permalink":"/udocs/Repositories/Blend_directives/pcWinCommand","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"pcWinCommand"},"sidebar":"sidebar","previous":{"title":"pc:void","permalink":"/udocs/Repositories/Blend_directives/pcvoid"},"next":{"title":"pc:WriteFile","permalink":"/udocs/Repositories/Blend_directives/pcWriteFile"}}');var s=t(74848),a=t(28453);const r={id:"pcWinCommand"},o="pc",c={},d=[{value:"<strong>pc</strong>",id:"pc-1",level:2},{value:"Return value",id:"return-value",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsxs)(n.h1,{id:"pc",children:["pc",":WinCommand"]})}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:["This article is about the ",(0,s.jsxs)(n.strong,{children:["pc",":WinCommand"]}),(0,s.jsx)(n.a,{href:"/Repositories/Blend_directives",children:" Blend directive"}),"."]})}),"\n",(0,s.jsx)(n.h2,{id:"pc-1",children:(0,s.jsxs)(n.strong,{children:["pc",":WinCommand"]})}),"\n",(0,s.jsx)(n.p,{children:"Runs a command line at OS level and passes it a command line with options/arguments/switches (if any)."}),"\n",(0,s.jsx)(n.p,{children:'Returns an XML fragment by way of a report. See the "Return value" section at the end of this help topic.'}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"Syntax"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'<pc:WinCommand\n     cmd="*file-path*"\n     args="*command-with-arguments*"\n     waittime="*waittime*" />\n'})}),"\n",(0,s.jsxs)(n.p,{children:["The required ",(0,s.jsx)(n.strong,{children:"cmd"})," is an absolute or relative file path leading to the executable that you want to pass the command line to. If a relative path (including a simple filename, as in the Example) is used, then whether or not the executable can be found depends on path environment variables. You can set environment variables from Blend by calling pc",":SetEnvVarDefault"," or pc",":SetEnvVarOverwrite","."]}),"\n",(0,s.jsxs)(n.p,{children:["The required ",(0,s.jsx)(n.strong,{children:"args"})," is the command line you want to pass to the executable."]}),"\n",(0,s.jsxs)(n.p,{children:["The optional ",(0,s.jsx)(n.strong,{children:"waittime"}),' specifies in milliseconds how long you want to wait for the command to respond. If the command does not complete within time, you get a return value (see the "Return value" section at the end of this help topic) without output. If you omit this attribute, the default waittime of 1000 milliseconds applies.']}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"Example 1"})}),"\n",(0,s.jsx)(n.p,{children:"This example lists folders and files contained by the working directory. This is a USoft Blend script processed by ublendit.exe from the command line."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<example xmlns:pc="Processing.Command" >\n  <pc:value-of mycmd="cmd.exe /C dir"/>\n  <pc:WinCommand cmd="cmd.exe" args="{$mycmd}"/>\n</example>\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"Example 2"})}),"\n",(0,s.jsx)(n.p,{children:"This example does the same as Example 1. This is a USoft Blend script processed from a USoft context."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"select uscsxsl.blend\n(\n    '<example xmlns:pc=\"Processing.Command\">\n       <pc:WinCommand cmd=\"cmd.exe\" args=\"{$mycmd}\"/>\n     </example>'\n,    'mycmd'\n,    'cmd.exe /C dir'\n)\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"Example 3"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<application xmlns:pc="Processing.Command">\n  <pc:assign-string-default\n    usoftexe = "\\\\FS.USOFT.COM\\prorep\\usd911A\\bin64\\usd.exe"\n    repargs= \'-app "REPORTER"  -title "Reporter 91" -oracle -owner OPS$REPORTER -ddfile -database\'\n    repconnection = \'"(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=NLBRNNT21.USOFT.COM)(PORT=1521))(CONNECT_DATA=(SID=P)))"\'\n    repuser = "-u REPORTERFUNNEL"\n    repfunnelpwd = \'-pw "*20*3e*3c*3e*295S*26Y*3bS*23*3a*23FG*2aMJ*3b8ER3*28*273*24O"\'\n  />\n  <pc:assign repargs="{concat($repargs, \' \', $repconnection, \' \', $repuser, \' \', $repfunnelpwd)}" />\n  <pc:WinCommand cmd="{$usoftexe}" args="{$repargs}"/>\n</application>\n'})}),"\n",(0,s.jsx)(n.h2,{id:"return-value",children:"Return value"}),"\n",(0,s.jsx)(n.p,{children:"The return value is an XML fragment that has this syntax:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'<CommandResult\n     cmd="*path-to-executable*"\n     args="*command-with-arguments*"\n     wd="*working-directory*"\n     waittime="*waittime*"\n     Busy="*busy*">\n  <Output> *output* </Output>\n</CommandResult>\n\n*busy*\xa0 ::=\xa0 { true | false }\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Waittime"})," (in milliseconds) is the waittime passed as an argument of <pc",":WinCommand",">, or else the default waittime of 1000 milliseconds. The ",(0,s.jsx)(n.strong,{children:"Busy"}),' attribute only appears if the command did not complete within the waittime. Busy="true" means that the process was running at the end of the waittime. For example:']}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<CommandResult cmd="cmd.exe" wd="C:\\Users\\P3100014\\AppData\\Local\\Temp" args="cmd.exe /C dir" waittime="1000">\n  <Output>\n    Volume in drive C has no label.\n    Volume serial number is 3C05-F345\n    Directory of C:\\Users\\P3100014\\AppData\\Local\\Temp\n23-06-2019   18:22    <DIR>    TCDCC97.tmp\n23-06-2019   18:22    <DIR>    TCDCC98.tmp\n24-06-2019   10:54        98.725     URL70B0.tmp\n24-06-2019   10:53             0     tmp5544.tmp\n24-06-2019   10:53        27.222     tmp5544.tmp_keyschema.xsl\n              3 File(s)          125.947 bytes\n              2 Dir(s)   91.130.769.408 bytes free\n  </Output>\n</CommandResult>\n'})}),"\n",(0,s.jsx)(n.p,{children:"\xa0"})]})}function m(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}}}]);