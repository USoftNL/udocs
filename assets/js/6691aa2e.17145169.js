"use strict";(self.webpackChunkudocs=self.webpackChunkudocs||[]).push([[13124],{28453:(e,t,o)=>{o.d(t,{R:()=>a,x:()=>i});var n=o(96540);const r={},s=n.createContext(r);function a(e){const t=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),n.createElement(s.Provider,{value:t},e.children)}},95050:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>n,toc:()=>h});const n=JSON.parse('{"id":"Extensions/RDMI_Components/Aggregate_protocol","title":"Aggregate protocol","description":"The aggregate protocol is a way of interacting with an RDMI component that involves passing a multi-row data set to the component and letting it return a single-record or single-value result. With the aggregate protocol you can:","source":"@site/docs/Extensions/RDMI_Components/Aggregate_protocol.md","sourceDirName":"Extensions/RDMI_Components","slug":"/Extensions/RDMI_Components/Aggregate_protocol","permalink":"/udocs/Extensions/RDMI_Components/Aggregate_protocol","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"Aggregate_protocol"},"sidebar":"sidebar","previous":{"title":"Component querying a CSV file","permalink":"/udocs/Extensions/RDMI_Components/Component_querying_a_CSV_file"},"next":{"title":"Component for exporting a data set to a CSV file","permalink":"/udocs/Extensions/RDMI_Components/Component_for_exporting_a_data_set_to_a_CSV_file"}}');var r=o(74848),s=o(28453);const a={id:"Aggregate_protocol"},i="Aggregate protocol",c={},h=[{value:"How the aggregate protocol works",id:"how-the-aggregate-protocol-works",level:3},{value:"How to call a component using the aggregate protocol",id:"how-to-call-a-component-using-the-aggregate-protocol",level:3}];function l(e){const t={h1:"h1",h3:"h3",header:"header",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"aggregate-protocol",children:"Aggregate protocol"})}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.strong,{children:"aggregate protocol"})," is a way of interacting with an RDMI component that involves passing a multi-row data set to the component and letting it return a single-record or single-value result. With the aggregate protocol you can:"]}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsx)(t.p,{children:"Produce a Word document, Excel spreadsheet, or CSV file by concatenating data in a multi-row data set."}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsx)(t.p,{children:"Feed a multi-row data set to an optimisation algorithm that produces a single value as its outcome, then continue processing by catching and processing that value."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"how-the-aggregate-protocol-works",children:"How the aggregate protocol works"}),"\n",(0,r.jsx)(t.p,{children:"First you need to make sure your RDMI component has one or more associated aggregate protocols. Each protocol designates one method as its EXE method, and another method as its FETCH method."}),"\n",(0,r.jsx)(t.p,{children:"Next, instead of calling a method of the component directly, you call an aggregate protocol name. An INVOKE ... WITH SELECT ... statement is processed as follows if the INVOKE calls an aggregate protocol name:"}),"\n",(0,r.jsx)(t.p,{children:"1.\xa0Execute the SELECT statement."}),"\n",(0,r.jsx)(t.p,{children:"2.\xa0Create an instance of the component."}),"\n",(0,r.jsx)(t.p,{children:"3.\xa0Fetch a record from the query result of the SELECT."}),"\n",(0,r.jsx)(t.p,{children:"4.\xa0Execute the protocol's EXE method, using as input parameters the output expression from the SELECT (the output expression in the fetched record)."}),"\n",(0,r.jsx)(t.p,{children:"5.\xa0Repeat Steps 3 and 4 until the component returns no further records, that is, until the FETCH method reports that there are no more records."}),"\n",(0,r.jsx)(t.p,{children:"6.\xa0Execute the protocol's FETCH method and catch the Out parameter. Return the record to the caller."}),"\n",(0,r.jsx)(t.p,{children:"7.\xa0Destroy the instance of the component if the component is stateless."}),"\n",(0,r.jsx)(t.h3,{id:"how-to-call-a-component-using-the-aggregate-protocol",children:"How to call a component using the aggregate protocol"}),"\n",(0,r.jsx)(t.p,{children:"By default, calls to component methods use the standard protocol. If you want to use the aggregate protocol instead:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Identify one method as being the EXE method of an aggregate protocol."}),"\n",(0,r.jsx)(t.li,{children:"Identify another method as being the FETCH method of that aggregate protocol."}),"\n",(0,r.jsx)(t.li,{children:"In the INVOKE clause, use the protocol name rather than a method name."}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"To specify methods as being the EXE and FETCH methods of a aggregate protocol:"}),"\n",(0,r.jsx)(t.p,{children:"1.\xa0First code the RDMI component and its methods. Save/commit."}),"\n",(0,r.jsx)(t.p,{children:"2.\xa0Make sure the return parameters of the methods you want to associate with the protocol are Long Integer (you will be warned if they are not.) When coding methods for the aggregate protocol (as for the query protocol), you must return the following standard integer values to express that a record is or is not found. See the example."}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{}),(0,r.jsx)(t.th,{})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"-1\xa0"}),(0,r.jsx)(t.td,{children:"Error."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"0"}),(0,r.jsx)(t.td,{children:"No record returned."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"1"}),(0,r.jsx)(t.td,{children:"Record returned."})]})]})]}),"\n",(0,r.jsx)(t.p,{children:"3.\xa0In the info window where you coded the RDMI component, click the Aggregate Protocol Associations tab page."}),"\n",(0,r.jsx)(t.p,{children:"4.\xa0Enter a unique name for the protocol. This name will be used in the INVOKE string instead of the method name."}),"\n",(0,r.jsx)(t.p,{children:"5.\xa0Enter the name of the EXE method in the Execute Method field."}),"\n",(0,r.jsx)(t.p,{children:"6.\xa0Enter the name of the FETCH method in the Fetch Method field."}),"\n",(0,r.jsx)(t.p,{children:"7.\xa0Save/commit."}),"\n",(0,r.jsx)(t.p,{children:"\xa0"})]})}function d(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}}}]);