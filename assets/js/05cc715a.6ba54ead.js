"use strict";(self.webpackChunkudocs=self.webpackChunkudocs||[]).push([[66510],{28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>a});var l=t(96540);const r={},s=l.createContext(r);function i(e){const n=l.useContext(s);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),l.createElement(s.Provider,{value:n},e.children)}},45330:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>d,frontMatter:()=>i,metadata:()=>l,toc:()=>c});const l=JSON.parse('{"id":"Extensions/USPowerShell_internal_component/USPowerShellExecuteScript","title":"USPowerShell.ExecuteScript","description":"This article is about the ExecuteScript method of the USPowerShell internal component.","source":"@site/docs/Extensions/USPowerShell_internal_component/USPowerShellExecuteScript.md","sourceDirName":"Extensions/USPowerShell_internal_component","slug":"/Extensions/USPowerShell_internal_component/USPowerShellExecuteScript","permalink":"/udocs/Extensions/USPowerShell_internal_component/USPowerShellExecuteScript","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"USPowerShellExecuteScript"},"sidebar":"sidebar","previous":{"title":"USPowerShell internal component","permalink":"/udocs/Extensions/USPowerShell_internal_component"},"next":{"title":"USXSL internal component","permalink":"/udocs/Extensions/USXSL_internal_component"}}');var r=t(74848),s=t(28453);const i={id:"USPowerShellExecuteScript"},a="USPowerShell.ExecuteScript",o={},c=[{value:"<strong>USPowerShell.ExecuteScript</strong>",id:"uspowershellexecutescript-1",level:2},{value:"Example: Simple script execution",id:"example-simple-script-execution",level:2},{value:"Example: Script execution with parameters",id:"example-script-execution-with-parameters",level:2},{value:"Example: Stateful test",id:"example-stateful-test",level:2},{value:"Example: Dynamically adding C#",id:"example-dynamically-adding-c",level:2},{value:"Example: Converting MS Word to PDF",id:"example-converting-ms-word-to-pdf",level:2},{value:"Example: Query call to the Rules Engine",id:"example-query-call-to-the-rules-engine",level:2},{value:"Example: Manipulation call to the Rules Engine",id:"example-manipulation-call-to-the-rules-engine",level:2},{value:"Example: Call to the Rules Engine with variables",id:"example-call-to-the-rules-engine-with-variables",level:2},{value:"Example: Query call to the Rules Engine and loop through result",id:"example-query-call-to-the-rules-engine-and-loop-through-result",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"uspowershellexecutescript",children:"USPowerShell.ExecuteScript"})}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["This article is about the ",(0,r.jsx)(n.strong,{children:"ExecuteScript"})," method of the ",(0,r.jsx)(n.a,{href:"/Extensions/USPowerShell_internal_component",children:"USPowerShell internal component"}),"."]})}),"\n",(0,r.jsx)(n.h2,{id:"uspowershellexecutescript-1",children:(0,r.jsx)(n.strong,{children:"USPowerShell.ExecuteScript"})}),"\n",(0,r.jsx)(n.p,{children:"Executes a script written in Windows PowerShell\xae."}),"\n",(0,r.jsx)(n.p,{children:"Windows PowerShell\xae is a task-based command-line shell and scripting language designed especially for system administration. Built on the .NET Framework, Windows PowerShell helps IT professionals and power users control and automate the administration of the Windows operating system and applications that run on Windows. Many examples and tips can be found on the internet."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.em,{children:"Syntax"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"INVOKE USPowerShell.ExecuteScript WITH\nSELECT     *powershell-script*\n,          *script-parameter,    value*\n,          \u2026\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The required ",(0,r.jsx)(n.em,{children:"powershell-script"})," identifies the script to be executed."]}),"\n",(0,r.jsxs)(n.p,{children:["The optional ",(0,r.jsx)(n.em,{children:"script-parameter - value"})," pairs specify parameters passed to the script. These parameters may be referred to within the script code by using the standard PowerShell\xae dollar-sign syntax. See the examples below."]}),"\n",(0,r.jsx)(n.p,{children:"The USPowerShell internal component is a stateful component, so any value set in a PowerShell\xae script can be used later in a different call to the ExecuteScript method."}),"\n",(0,r.jsx)(n.p,{children:"In addition to the PowerShell\xae variables and other script parameters that are available by default, you can use a USoft-defined object called $USEngine. This object contains an instance of the USoft RulesEngine and has two methods which can be called from a PowerShell\xae script:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\xa0\xa0\xa0 $USEngine.ExecuteSQLQuery"}),"\n",(0,r.jsx)(n.li,{children:"\xa0\xa0 \xa0$USEngine.ExecuteSQLManipulation"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Both methods take a SQL statement as the first parameter followed by 0 or more parameters with values that can be used inside the SQL. The values can be accessed using the placeholder notation :1, :2 ... The ExecuteSQLQuery() method returns the data retrieved. The ExecuteSQLManipulation method returns the number of rows manipulated."}),"\n",(0,r.jsx)(n.p,{children:"The examples below demonstrate in more detail how these methods can be used in a PowerShell\xae script."}),"\n",(0,r.jsx)(n.h2,{id:"example-simple-script-execution",children:"Example: Simple script execution"}),"\n",(0,r.jsx)(n.p,{children:"Here is an example of the execution of a simple PowerShell script:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"INVOKE    USPowerShell.ExecuteScript\nWITH\nSELECT    'Write-Output \"Hello World\"'\n"})}),"\n",(0,r.jsx)(n.p,{children:"This results in:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Hello World\n"})}),"\n",(0,r.jsx)(n.h2,{id:"example-script-execution-with-parameters",children:"Example: Script execution with parameters"}),"\n",(0,r.jsx)(n.p,{children:"Here is an example of the execution of a simple PowerShell script with script parameters:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"INVOKE    USPowerShell.ExecuteScript\nWITH\nSELECT   'Write-Output \"The values of the parameters passed are $PARAM1 and ''$PARAM2''\"'\n,        'PARAM1', 133.57\n,        'PARAM2', 'Parameter value 2'\n"})}),"\n",(0,r.jsx)(n.p,{children:"This results in:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"The values of the parameters passed on are 133.57 and 'Parameter value 2'\n"})}),"\n",(0,r.jsx)(n.h2,{id:"example-stateful-test",children:"Example: Stateful test"}),"\n",(0,r.jsx)(n.p,{children:"Here is an example which demonstrates the statefulness of the PowerShell component\n\xa0"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"INVOKE USPowershell.ExecuteScript\nWITH\nSELECT '$mymsg = \"Hello World, I''m stateful.\" ';\n\nINVOKE USPowershell.ExecuteScript\nWITH\nSELECT 'Write-Output $mymsg'\n"})}),"\n",(0,r.jsx)(n.p,{children:"This results in:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Hello World, I'm stateful.\n"})}),"\n",(0,r.jsx)(n.h2,{id:"example-dynamically-adding-c",children:"Example: Dynamically adding C#"}),"\n",(0,r.jsx)(n.p,{children:"Here is an example of how the PowerShell script functionality may be extended by adding C# code:\n\xa0"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"INVOKE USPowershell.ExecuteScript\nWITH\nSELECT 'Add-Type -Language CSharpVersion3 -TypeDefinition @\"\nusing System;\n\npublic class Class1\n{\n    public static String MyMethod()\n    {\n       return \"Hello World!\";\n    }\n}\n\"@';\n\nINVOKE USPowershell.ExecuteScript\nWITH\nSELECT 'Write-Output([Class1]::MyMethod())'\n"})}),"\n",(0,r.jsx)(n.p,{children:"This results in:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Hello World!\n"})}),"\n",(0,r.jsx)(n.p,{children:"Since USPowershell is a stateful component, once the Class has been added, it remains available for later use."}),"\n",(0,r.jsx)(n.h2,{id:"example-converting-ms-word-to-pdf",children:"Example: Converting MS Word to PDF"}),"\n",(0,r.jsx)(n.p,{children:"Here is an example of a PowerShell script which uses MS Word to convert a Word document to PDF:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:'INVOKE USPowershell.ExecuteScript\nWITH\nSELECT \'\n$word_app = New-Object -ComObject Word.Application\n$document = $word_app.Documents.Open("C:\\Temp\\MyDocument.docx")\n$document.SaveAs([ref] "C:\\Temp\\MyDocument.pdf", [ref] 17)\n$document.Close()\n$word_app.Quit()\n\'\n'})}),"\n",(0,r.jsx)(n.p,{children:'This causes a file "C:\\Temp\\MyDocument.pdf" to be generated.'}),"\n",(0,r.jsx)(n.h2,{id:"example-query-call-to-the-rules-engine",children:"Example: Query call to the Rules Engine"}),"\n",(0,r.jsx)(n.p,{children:"Here is an example of a PowerShell script which uses the $USEngine object to execute a database query:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"INVOKE USPowershell.ExecuteScript\nWITH\nSELECT 'Write-Output $USEngine.ExecuteSQLQuery(\"select table_name from t_table\") '\n"})}),"\n",(0,r.jsx)(n.p,{children:"This results in a list of tables, such as:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"TABLE_SEQUENCE_NUMBERS\nT_EVENT\nT_APP_TIME\n"})}),"\n",(0,r.jsx)(n.h2,{id:"example-manipulation-call-to-the-rules-engine",children:"Example: Manipulation call to the Rules Engine"}),"\n",(0,r.jsx)(n.p,{children:"Here is an example of a PowerShell script which uses the $USEngine object to perform a manipulation.\nThe return value is the number of records affected by the manipulation."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"INVOKE USPowershell.ExecuteScript\nWITH\nSELECT 'Write-Output $USEngine.ExecuteSQLManipulation(\"update t_table set table_short = ''TEV'' where table_name = ''T_EVENT'' \") '\n"})}),"\n",(0,r.jsx)(n.p,{children:"This results in:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"1\n"})}),"\n",(0,r.jsx)(n.h2,{id:"example-call-to-the-rules-engine-with-variables",children:"Example: Call to the Rules Engine with variables"}),"\n",(0,r.jsx)(n.p,{children:"Here is an example of a PowerShell script which uses the $USEngine object to execute a database query and passes variables to the SQL statement:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:'INVOKE USPowershell.ExecuteScript\nWITH\nSELECT \'Write-Output $USEngine.ExecuteSQLQuery("select table_name || :1, :2 from t_table ", "_TST", 12345)  \'\n'})}),"\n",(0,r.jsx)(n.p,{children:"This results in:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"TABLE_SEQUENCE_NUMBERS_TST    12345\nT_APP_TIME_TST    12345\nT_EVENT_TST    12345\n"})}),"\n",(0,r.jsx)(n.h2,{id:"example-query-call-to-the-rules-engine-and-loop-through-result",children:"Example: Query call to the Rules Engine and loop through result"}),"\n",(0,r.jsx)(n.p,{children:"Here is an example of a PowerShell script which uses the $USEngine object to execute a database query and then loops through the returning recordset:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:'INVOKE USPowershell.ExecuteScript\nWITH\nSELECT \'$USEngine.ExecuteSQLQuery("select domain_name, f_total_length from t_domain")  | foreach {\n     "The first column is of type " + $_[0].GetType() + " and has the value " + $_[0]\n     "The second column is of type " + $_[1].GetType() + " and has the value " + $_[1]\n}\'\n'})}),"\n",(0,r.jsx)(n.p,{children:"This results in:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"The first column is of type string and has the value LONG_TEXT\nThe second column is of type decimal and has the value 500\nThe first column is of type string and has the value SHORT_TEXT\nThe second column is of type decimal and has the value 1\n(...)\n"})}),"\n",(0,r.jsx)(n.p,{children:"\xa0"})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}}}]);