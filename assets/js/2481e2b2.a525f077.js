"use strict";(self.webpackChunkudocs=self.webpackChunkudocs||[]).push([[35413],{93:(e,n,t)=>{t.d(n,{A:()=>o});const o=t.p+"assets/images/e44b0700-e28f-4d36-bc79-7fa9c587791e-a06603e1148a1569823eaec8d55c1a58.png"},28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>a});var o=t(96540);const i={},s=o.createContext(i);function r(e){const n=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),o.createElement(s.Provider,{value:n},e.children)}},48466:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>l,frontMatter:()=>r,metadata:()=>o,toc:()=>h});const o=JSON.parse('{"id":"Authorisation_and_access/Roles/Role_conditions","title":"Role conditions","description":"A role condition is a SQL condition attached to a Table Right.","source":"@site/docs/Authorisation_and_access/Roles/Role_conditions.md","sourceDirName":"Authorisation_and_access/Roles","slug":"/Authorisation_and_access/Roles/Role_conditions","permalink":"/udocs/Authorisation_and_access/Roles/Role_conditions","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"Role_conditions"},"sidebar":"sidebar","previous":{"title":"Column rights","permalink":"/udocs/Authorisation_and_access/Roles/Column_rights"},"next":{"title":"Access rights for different table types","permalink":"/udocs/Authorisation_and_access/Roles/Access_rights_for_different_table_types"}}');var i=t(74848),s=t(28453);const r={id:"Role_conditions"},a="Role conditions",c={},h=[{value:"Syntax",id:"syntax",level:3},{value:"Scope of role conditions",id:"scope-of-role-conditions",level:3},{value:"Defining a role condition",id:"defining-a-role-condition",level:3},{value:"",id:"",level:3}];function d(e){const n={admonition:"admonition",code:"code",em:"em",h1:"h1",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"role-conditions",children:"Role conditions"})}),"\n",(0,i.jsxs)(n.p,{children:["A ",(0,i.jsx)(n.strong,{children:"role condition"})," is a SQL condition attached to a Table Right."]}),"\n",(0,i.jsxs)(n.p,{children:["A role condition ",(0,i.jsx)(n.strong,{children:"restricts"})," the access afforded by the Table Right. Without the condition, the right would cover all the records in the table. With the condition attached, it covers only the subset of records that satisfy the condition."]}),"\n",(0,i.jsx)(n.p,{children:"The condition is like a WHERE clause that would restrict a query result to that subset of records if it were used as part of an explicit SQL SELECT statement."}),"\n",(0,i.jsx)(n.h3,{id:"syntax",children:"Syntax"}),"\n",(0,i.jsx)(n.p,{children:"In role condition syntax, the top-level WHERE keyword is understood but not written. Table aliases are allowed, but the table instance of the Table Right that you attach the condition to must be spelled in full. An alternative to this is the use of the special keyword alias:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"tauth\n\n"})}),"\n",(0,i.jsxs)(n.p,{children:["which has meaning only in role conditions. This alias automatically represents the table instance of the access right that you attach the condition to. In theory, an advantage of using the ",(0,i.jsx)(n.strong,{children:"tauth"})," alias is that you can attach the condition to multiple Table Rights for different tables, but in practice that only works if those tables happen to have the same column names."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Example"})}),"\n",(0,i.jsx)(n.p,{children:"This example is like a WHERE EXISTS clause. A user is allowed access to a table TOUR, but only to the subset of TOUR records that are linked (through a Relationship, a RELATE clause) to a parent record in a PERSON table that identifies her as the currently logged-in user (represent by keyword user)."}),"\n",(0,i.jsx)(n.p,{children:"The corresponding Table Right in this case is for table TOUR. Below are 3 alternatives."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Syntax 1"})}),"\n",(0,i.jsxs)(n.p,{children:["This syntax shows how you can represent the table instance of the access right by the ",(0,i.jsx)(n.strong,{children:"table name written in full"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"exists\n(\n \xa0 \xa0select \xa0 ''\n \xa0 \xa0from \xa0 \xa0 guide g\n \xa0 \xa0where \xa0 \xa0g.person_id = tour.guide\n \xa0 \xa0and \xa0 \xa0 \xa0g.login_name = user\n)\n\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Syntax 2"})}),"\n",(0,i.jsxs)(n.p,{children:["This syntax shows how you can represent the table instance of the access right by the ",(0,i.jsx)(n.strong,{children:"tauth"})," keyword alias:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"exists\n(\n \xa0 \xa0select \xa0 ''\n \xa0 \xa0from \xa0 \xa0 guide g\n \xa0 \xa0where \xa0 \xa0g.person_id = tauth.guide\n \xa0 \xa0and \xa0 \xa0 \xa0g.login_name = user\n)\n\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Syntax 3"})}),"\n",(0,i.jsxs)(n.p,{children:["This syntax shows that the ",(0,i.jsx)(n.strong,{children:"tauth"})," keyword alias is also permitted as a table placeholder in RELATE clauses:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"exists\n(\n \xa0 \xa0select \xa0 ''\n \xa0 \xa0from \xa0 \xa0 guide g\n \xa0 \xa0relate \xa0 g \"GUIDES\" tauth\n \xa0 \xa0where \xa0 \xa0g.login_name = user\n)\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"scope-of-role-conditions",children:"Scope of role conditions"}),"\n",(0,i.jsxs)(n.p,{children:["A role condition can have either ",(0,i.jsx)(n.strong,{children:"Foreground"})," or ",(0,i.jsx)(n.strong,{children:"Background"})," scope, but this also depends on the Table Right it is attached to:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Role conditions attached to SELECT rights can only have Foreground scope."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Role conditions attached to INSERT, UPDATE and DELETE rights can have either Foreground or Background scope."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Role conditions cannot be attached to a Table Right with Scope = None. There is nothing for the condition to restrict."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Role conditions attached to a Table Right with Scope = Background-only must themselves have Background scope."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["To an INSERT, UPDATE or DELETE right with Scope = Foreground-and-background, you can add restricting conditions for Foreground access and Background access ",(0,i.jsx)(n.strong,{children:"separately"}),". This gives you the option to restrict one type of access and not the other; to restrict each by a different condition; or to restrict both by the same condition."]}),"\n",(0,i.jsx)(n.h3,{id:"defining-a-role-condition",children:"Defining a role condition"}),"\n",(0,i.jsx)(n.p,{children:"To define a role condition:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Determine the Role and the Table Right for which you want to restrict access by adding the new condition."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"(Suggested:) In the C/S User Application, in SQL Command, try out the condition by appending it to a query (a SELECT statement) on the table. Once you are satisfied with the result, copy-and-paste the WHERE clause to the clipboard so that you can use it to define the role condition."}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"In USoft Definer, from the menu, choose Define, Role Conditions."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Write or paste your SQL condition in the Condition field, making sure you omit the top-level WHERE keyword. This keyword is understood but not written."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Save work. See that USoft Definer creates and displays a unique ID for your condition."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["(See ",(0,i.jsx)(n.em,{children:"Example"})," below.) From the menu, choose Define, Roles. Retrieve the Role where you want to use the condition. On the Table Rights tab, find the record for the table right that you want to attach the condition to. Depending on the access right (SELECT, INSERT, UPDATE or DELETE), and the scope (Foreground, Background), write the ID of the condition in the correct column. Save work."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsx)(n.p,{children:"The Role will now have Correct = No. Press the Check button to get it to have Correct = Yes."})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Example"})}),"\n",(0,i.jsx)(n.p,{children:"In this example, for users holding the GUIDE role, the role condition with ID = 2 has been attached. This condition restricts the record set in table RESERVATION that these users may SELECT from:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(93).A+"",width:"630",height:"422"})}),"\n",(0,i.jsx)(n.h3,{id:"",children:"\xa0"})]})}function l(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);