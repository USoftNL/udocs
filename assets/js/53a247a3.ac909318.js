"use strict";(self.webpackChunkudocs=self.webpackChunkudocs||[]).push([[54325],{28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>c});var i=t(96540);const s={},r=i.createContext(s);function a(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(r.Provider,{value:n},e.children)}},41638:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>l,frontMatter:()=>a,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"Modeller_and_Rules_Engine/RDBMS_and_data_connectivity/USoft_as_a_DDE_client","title":"USoft as a DDE client","description":"This section describes how to use a USoft application as a DDE Client. This involves starting and finishing the conversation, requesting and sending items, executing commands, and running advise loops in order to be notified when a certain item changes.","source":"@site/docs/Modeller_and_Rules_Engine/RDBMS_and_data_connectivity/USoft_as_a_DDE_client.md","sourceDirName":"Modeller_and_Rules_Engine/RDBMS_and_data_connectivity","slug":"/Modeller_and_Rules_Engine/RDBMS_and_data_connectivity/USoft_as_a_DDE_client","permalink":"/udocs/Modeller_and_Rules_Engine/RDBMS_and_data_connectivity/USoft_as_a_DDE_client","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"USoft_as_a_DDE_client"},"sidebar":"sidebar","previous":{"title":"Dynamic Data Exchange (DDE)","permalink":"/udocs/Modeller_and_Rules_Engine/RDBMS_and_data_connectivity/Dynamic_Data_Exchange_DDE"},"next":{"title":"USoft as a DDE server","permalink":"/udocs/Modeller_and_Rules_Engine/RDBMS_and_data_connectivity/USoft_as_a_DDE_server"}}');var s=t(74848),r=t(28453);const a={id:"USoft_as_a_DDE_client"},c="USoft as a DDE client",o={},d=[{value:"Starting and finishing DDE conversations",id:"starting-and-finishing-dde-conversations",level:2},{value:"Requesting and sending items",id:"requesting-and-sending-items",level:2},{value:"Executing a command",id:"executing-a-command",level:2},{value:"Running an advise loop",id:"running-an-advise-loop",level:2}];function h(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"usoft-as-a-dde-client",children:"USoft as a DDE client"})}),"\n",(0,s.jsx)(n.p,{children:"This section describes how to use a USoft application as a DDE Client. This involves starting and finishing the conversation, requesting and sending items, executing commands, and running advise loops in order to be notified when a certain item changes."}),"\n",(0,s.jsx)(n.h2,{id:"starting-and-finishing-dde-conversations",children:"Starting and finishing DDE conversations"}),"\n",(0,s.jsx)(n.p,{children:"DDE conversations are conversations with a particular service about a particular topic. Before items can be exchanged or commands sent, a DDE connection must be established. When the conversation is finished, the connection must be closed. Each connection can be uniquely identified by its service name and its topic. This means that a client cannot have two conversations with the same service about the same topic at the same time."}),"\n",(0,s.jsx)(n.p,{children:"To start a DDE conversation, call:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"DdeConnect( service, topic )\n"})}),"\n",(0,s.jsx)(n.p,{children:"To finish a DDE conversation, call:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"DdeDisconnect( service, topic )\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:"Service"}),' is the name with which the DDE server has registered itself. The name of the service is usually identical to the application name. The server name of USoft Developer is "USoft Developer".']}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:"Topic"})," is the name of the topic. The topic must be supported by the server."]}),"\n",(0,s.jsx)(n.h2,{id:"requesting-and-sending-items",children:"Requesting and sending items"}),"\n",(0,s.jsx)(n.p,{children:'In a DDE conversation, the client may send items to the server and request items from it. USoft Developer supports sending field values to a DDE server and retrieving field values from it. These fields are fields from currently open windows. The item name of a particular field is "ObjectNamePlural.ColumnName" (where "ObjectNamePlural" is the Object Name Plural as defined in the repository, and "ColumnName" is the name of the column underlying the field).'}),"\n",(0,s.jsx)(n.p,{children:"When you request or send an item, you must specify its format, which is one of the available Windows data formats. You must also specify the resource of the current Field that is either set to the requested item or queried to obtain the value of the item to be sent."}),"\n",(0,s.jsx)(n.p,{children:"To request an item, call:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"DdeRequest( service, topic, item, format, resource )\n"})}),"\n",(0,s.jsx)(n.p,{children:"To set an item in the server, call:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"DdePoke( service, topic, item, format, resource )\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:"Service"})," and ",(0,s.jsx)(n.em,{children:"topic"})," refer to a current DDE conversation, which must have been opened by a call to DdeConnect()."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:"Item"})," is the requested item."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:"Format"})," is the format in which this item is to be delivered. The standard string representing the MS Windows data format is CF_TEXT."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:"Resource"}),' is the resource of the current object that should be set to the value returned by the call to DdeRequest(). At this moment, only the "value" resource is supported. This means that DdeRequest() can only be used to set a value in the current field. This may be the field from which this action is called or the client of the decision calling this action.']}),"\n",(0,s.jsx)(n.h2,{id:"executing-a-command",children:"Executing a command"}),"\n",(0,s.jsx)(n.p,{children:"Some DDE servers can execute commands. These commands are identified by command strings, which can be sent to them within the current conversation."}),"\n",(0,s.jsx)(n.p,{children:"To send a command to a DDE server, call:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"DdeExecute( service, topic, string )\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:"Service"})," and ",(0,s.jsx)(n.em,{children:"topic"})," identify the conversation as part of which the command is sent. This conversation must have been started with:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"DdeConnect( service, topic )\n"})}),"\n",(0,s.jsx)(n.p,{children:"and must not have been finished with:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"DdeDisconnect( service, topic )\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:"String"})," is the command to be executed by the server."]}),"\n",(0,s.jsx)(n.h2,{id:"running-an-advise-loop",children:"Running an advise loop"}),"\n",(0,s.jsx)(n.p,{children:"A DDE client can express interest in a particular item maintained by the DDE server by starting an advise loop for that item. The server notifies the client whenever that item changes, as long as the client has not stopped the advise loop. You may run only one advise loop for each item in a particular conversation."}),"\n",(0,s.jsx)(n.p,{children:"To start an advise loop from USoft Developer, call:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"DdeStartAdvise( service, topic, item, format, resource )\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:"Service"})," and ",(0,s.jsx)(n.em,{children:"topic"})," uniquely identify the current conversation, which must have been started with:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"DdeConnect( service, topic )\n"})}),"\n",(0,s.jsx)(n.p,{children:"and may not have been finished with"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"DdeDisconnect( service, topic )\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:"Item"})," is the item in which the client wants to express an interest."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:"Format"})," is the format in which it should be delivered."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:"Resource"}),' is the resource of the current object that should be set to the value returned by the call to DdeRequest(). At this moment, only the "value" resource is supported. This means that DdeRequest() can only be used to set a value in the current field. This may be the field from which this action is called or the client of the decision calling this action.']}),"\n",(0,s.jsx)(n.p,{children:"To stop a running advise loop, call:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"DdeStopAdvise( service, topic, item )\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:"Service"})," and ",(0,s.jsx)(n.em,{children:"topic"})," identify the current conversation. ",(0,s.jsx)(n.em,{children:"Item"})," is the item in which the client expressed interest."]})]})}function l(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}}}]);