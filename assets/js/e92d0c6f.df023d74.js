"use strict";(self.webpackChunkudocs=self.webpackChunkudocs||[]).push([[38952],{28453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>o});var i=n(96540);const a={},s=i.createContext(a);function r(e){const t=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),i.createElement(s.Provider,{value:t},e.children)}},73359:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"Modeller_and_Rules_Engine/Constraints_advanced_and_the_Rules_Engine/Time_constraints","title":"Time constraints","description":"USoft Production has an application timer that allows scheduled constraint execution. The timer consists of an application table TAPPTIME, and an executable USCLOCK.EXE that updates TAPPTIME with the current database time at regular intervals.","source":"@site/docs/Modeller_and_Rules_Engine/Constraints_advanced_and_the_Rules_Engine/Time_constraints.md","sourceDirName":"Modeller_and_Rules_Engine/Constraints_advanced_and_the_Rules_Engine","slug":"/Modeller_and_Rules_Engine/Constraints_advanced_and_the_Rules_Engine/Time_constraints","permalink":"/udocs/Modeller_and_Rules_Engine/Constraints_advanced_and_the_Rules_Engine/Time_constraints","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"Time_constraints"},"sidebar":"sidebar","previous":{"title":"Startup constraints","permalink":"/udocs/Modeller_and_Rules_Engine/Constraints_advanced_and_the_Rules_Engine/Startup_constraints"},"next":{"title":"Tuning your application","permalink":"/udocs/Modeller_and_Rules_Engine/Tuning_your_application"}}');var a=n(74848),s=n(28453);const r={id:"Time_constraints"},o="Time constraints",l={},c=[{value:"The T_APP_TIME table",id:"the-t_app_time-table",level:2},{value:"The Application Timer",id:"the-application-timer",level:2},{value:"Starting and stopping the Application Timer",id:"starting-and-stopping-the-application-timer",level:2}];function d(e){const t={admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"time-constraints",children:"Time constraints"})}),"\n",(0,a.jsx)(t.p,{children:"USoft Production has an application timer that allows scheduled constraint execution. The timer consists of an application table T_APP_TIME, and an executable USCLOCK.EXE that updates T_APP_TIME with the current database time at regular intervals."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.em,{children:"Example"})}),"\n",(0,a.jsx)(t.p,{children:"You can use a time constraint for future changes of customer addresses. Suppose, customers can announce a new address and the date from which the new address takes effect. The application must automatically replace the old address with the new address at the right time."}),"\n",(0,a.jsx)(t.p,{children:"This data is stored in a separate NEW_ADDRESS table."}),"\n",(0,a.jsx)(t.p,{children:"When the date arrives, the automatic update of the only record in the T_APP_TIME table causes the evaluation of a productive SET_NEW_ADDRESS constraint that updates the PERSON table."}),"\n",(0,a.jsx)(t.p,{children:"This constraint has SQL statement:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"UPDATE \xa0 \xa0 person p\nSET \xa0 \xa0 \n(\n \xa0 \xa0 \xa0 \xa0 \xa0 p.address\n, \xa0 \xa0 \xa0 \xa0 \xa0p.city\n, \xa0 \xa0 \xa0 \xa0 \xa0p.area_code\n) =\n(\n \xa0 \xa0SELECT \xa0 \xa0 na.address\n \xa0 \xa0, \xa0 \xa0 \xa0 \xa0 \xa0na.city\n \xa0 \xa0, \xa0 \xa0 \xa0 \xa0 \xa0na.area_code\n \xa0 \xa0FROM \xa0 \xa0 \xa0 new_address na\n \xa0 \xa0, \xa0 \xa0 \xa0 \xa0 \xa0t_app_time tt\n \xa0 \xa0WHERE \xa0 \xa0 \xa0na.person_id = p.person_id\n \xa0 \xa0AND \xa0 \xa0 \xa0 \xa0tt.app_year = \xa0TO_NUMBER( TO_CHAR( na.from_date,'YYYY' )) \xa0 \xa0 \n \xa0 \xa0AND \xa0 \xa0 \xa0 \xa0tt.app_month = TO_NUMBER( TO_CHAR( na.from_date,'MM' ))\n \xa0 \xa0AND \xa0 \xa0 \xa0 \xa0tt.app_day = \xa0 TO_NUMBER( TO_CHAR( na.from_date,'DD' ))\n)\n"})}),"\n",(0,a.jsx)(t.p,{children:"with transition properties:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"Transition Table = \xa0 \xa0T_APP_TIME\nFire On Insert = \xa0 \xa0 \xa0Never\nFire On Delete = \xa0 \xa0 \xa0Never\nFire On Update = \xa0 \xa0 \xa0UsedColumns\n"})}),"\n",(0,a.jsx)(t.h2,{id:"the-t_app_time-table",children:"The T_APP_TIME table"}),"\n",(0,a.jsx)(t.p,{children:'The T_APP_TIME table is predefined in every user application definition, and can be created in the same way other tables are created. When the application timer is running, table T_APP_TIME contains exactly one record that reflects the current "application" date and time.'}),"\n",(0,a.jsx)(t.p,{children:"Constraints that are defined on T_APP_TIME, and that are successful, have the effect of scheduled updates of the database."}),"\n",(0,a.jsx)(t.p,{children:"The T_APP_TIME table contains the following columns:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"APP_WEEKDAY (1=Sunday, 7=Saturday)"}),"\n",(0,a.jsx)(t.li,{children:"APP_YEAR (4 digits, not century based)"}),"\n",(0,a.jsx)(t.li,{children:"APP_MONTH (1=January, 12=December)"}),"\n",(0,a.jsx)(t.li,{children:"APP_DAY"}),"\n",(0,a.jsx)(t.li,{children:"APP_HOUR"}),"\n",(0,a.jsx)(t.li,{children:"APP_MINUTE"}),"\n",(0,a.jsx)(t.li,{children:"APP_SECOND"}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"All columns have the NUMBER data type and contain an integer."}),"\n",(0,a.jsx)(t.h2,{id:"the-application-timer",children:"The Application Timer"}),"\n",(0,a.jsx)(t.p,{children:"The application timer (USCLOCK.EXE) can be run continuously against the USoft Developer-built application. The timer keeps the T_APP_TIME table synchronized with the database time by incrementing it at fixed intervals. After each increment and the execution of the constraints that are evaluated by the increment, the application timer commits the transaction. The application timer rolls back the transaction and stops if it encounters a violation as a result of an increment."}),"\n",(0,a.jsx)(t.p,{children:"The application manager should ensure that only one instance of the application timer is running against a T_APP_TIME table."}),"\n",(0,a.jsx)(t.p,{children:"The application timer contains an instance of the USoft Rules Engine. When USCLOCK.EXE is started, it reads the constraints from the repository or from flat files. For this reason, you must stop and restart the timer when you have changed the constraints on T_APP_TIME."}),"\n",(0,a.jsx)(t.p,{children:"When the application timer is started, it first checks the current record in T_APP_TIME. When the application time is too far behind the database time, it reports an error and aborts. Otherwise, the application timer will quickly update the application time to synchronize it with the database time. In this way all intermediate updates are performed as if the timer had been running all the time. This is important to remember when the application timer is restarted after it has stopped, for example, because of a violation that occurred."}),"\n",(0,a.jsx)(t.p,{children:"By default, the application timer continuously displays the current time. This allows you to see that it is working. The timer displays the database time, which may differ from the local time on the PC."}),"\n",(0,a.jsx)(t.admonition,{type:"note",children:(0,a.jsx)(t.p,{children:"You should only write productive constraints for use with the timer. You should also make sure that when such constraints are evaluated, they cannot lead to violations, or messages requiring user interaction."})}),"\n",(0,a.jsx)(t.h2,{id:"starting-and-stopping-the-application-timer",children:"Starting and stopping the Application Timer"}),"\n",(0,a.jsx)(t.p,{children:"You can start the application timer from the USoft Binder. Add a USoft Application Timer project item to your project and edit the item properties. These are:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"Interval: this is the time between successive increments of the application time. The default value is one minute."}),"\n",(0,a.jsx)(t.li,{children:"Max time since last update: this is the maximum time difference between the database clock and the application clock that the application timer will allow when it is started. If the application time is further behind the database time than this value, the application timer stops and displays an error message. The default value is 24 hours."}),"\n",(0,a.jsx)(t.li,{children:"A Verbose check box, which if left unchecked, disables start-up messages and the continuous display of current time."}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"Refer to the USoft Binder help for more information about the USoft Binder and how to use it."}),"\n",(0,a.jsx)(t.p,{children:"While the application timer is running, you may minimize its window. To stop the application timer, restore its window, make it active and press CTRL+C or CTRL+BREAK. Do not close the window, log off, or shutdown while the application timer is running. Depending upon your RDBMS, the database connection may not be properly closed and database locks may not be released if the timer is stopped in this way."}),"\n",(0,a.jsx)(t.p,{children:"\xa0"})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}}}]);