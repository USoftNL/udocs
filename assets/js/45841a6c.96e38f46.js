"use strict";(self.webpackChunkudocs=self.webpackChunkudocs||[]).push([[93837],{28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>i});var o=t(96540);const r={},a=o.createContext(r);function s(e){const n=o.useContext(a);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),o.createElement(a.Provider,{value:n},e.children)}},56351:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>p,frontMatter:()=>s,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"Extensions/DotNet_components/DotNetUSoft_data_provider","title":"DotNet-USoft data provider","description":"There are two ways you can use application data in a .NET component defined in USoft Definer:","source":"@site/docs/Extensions/DotNet_components/DotNetUSoft_data_provider.md","sourceDirName":"Extensions/DotNet_components","slug":"/Extensions/DotNet_components/DotNetUSoft_data_provider","permalink":"/udocs/Extensions/DotNet_components/DotNetUSoft_data_provider","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"DotNetUSoft_data_provider"},"sidebar":"sidebar","previous":{"title":"XSL Stylesheet component example: Creating a PDF report","permalink":"/udocs/Extensions/DotNet_components/XSL_Stylesheet_component_example_Creating_a_PDF_report"},"next":{"title":"Component references and inheritance for dotNet","permalink":"/udocs/Extensions/DotNet_components/Component_references_and_inheritance_for_dotNet"}}');var r=t(74848),a=t(28453);const s={id:"DotNetUSoft_data_provider"},i="DotNet-USoft data provider",d={},c=[];function l(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"dotnet-usoft-data-provider",children:"DotNet-USoft data provider"})}),"\n",(0,r.jsx)(n.p,{children:"There are two ways you can use application data in a .NET component defined in USoft Definer:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"By passing application data as parameters to the component."}),"\n",(0,r.jsx)(n.li,{children:'By executing a query, from the .NET code, to the running Rules Engine using a .NET-USoft data provider. This provider is called "REDataProvider" and is delivered in assembly file "REDataProvider.dll". "REDataProvider" has the following classes:'}),"\n"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Class"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Description"})})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"USoftCommand"}),(0,r.jsx)(n.td,{children:"Represents a SQL statement to execute against a running Rules Engine. Inherits from DbCommand"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"USoftConnection"}),(0,r.jsx)(n.td,{children:"Represents a connection to a running Rules Engine. Inherits from DbConnection"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"USoftDataReader"}),(0,r.jsx)(n.td,{children:"Provides a way of reading a forward-only stream of rows from a running Rules Engine. Inherits from DbDataReader"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"USoftParameter"}),(0,r.jsx)(n.td,{children:"Represents a parameter to a USoftCommand. Inherits from IDataParameter"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"USoftParameterCollection"}),(0,r.jsx)(n.td,{children:"Represents a collection of parameters associated with a USoftCommand. Inherits from ArrayList, IDataParameterCollection."})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:["To connect back to the Rules Engine you need to derive your class from a predefined RulesEngine class. In order to acquire a connection to the Rules Engine you need to call the predefined ",(0,r.jsx)(n.strong,{children:"getConnection()"})," function. This function returns a USoftConnection object. Using this object, you can work with the connection object in the standard ADO.Net manner."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.em,{children:"Example"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-language-cs",children:'using System;\nusing System.Data;\nusing UsoftDataProvider;\nclass RulesEngineSQL\n{\npublic static string sql = "SELECT p.email_address FROM person p, participant pt WHERE p.person_id = pt.person_id and pt.res_id = ?";\n}\nclass DBExample : RulesEngine\n{\npublic void InformParticipans(int reservation_id, string message)\n{\nUSoftConnection conn = getConnection();\nconn.Open();\nUSoftCommand cmd = (USoftCommand)conn.CreateCommand();\ncmd.CommandText = RulesEngineSQL.sql;\nUSoftParameter p = new USoftParameter("reservation_id", DbType.Int32);\np.Value = reservation_id;\ncmd.Parameters.Add(p);\nIDataReader reader = cmd.ExecuteReader();\nwhile (reader.Read())\n{\nString email = reader.GetString(0) ;\n//send an email to participant\n}\nreader.Close();\nconn.Close();\n}\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["For more information on .NET data sources, refer to ",(0,r.jsx)(n.a,{href:"http://msdn.microsoft.com",children:"http://msdn.microsoft.com"}),"."]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsx)(n.p,{children:"To take advantage of planned future developments related to cross referencing of SQL within C# code, declare all your SQL statements as static attributes in the RulesEngineSQL class."})})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}}}]);