"use strict";(self.webpackChunkudocs=self.webpackChunkudocs||[]).push([[10295],{14787:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>d,frontMatter:()=>o,metadata:()=>t,toc:()=>h});const t=JSON.parse('{"id":"Services/Event_processing/Event_handling_Example_2_Queue_service_that_processes_input_events","title":"Event handling Example 2: Queue service that processes input events","description":"The following step-by-step instructions are for creating a queue service that processes incoming reservation events for a Travel Agency model in an asynchronous fashion.","source":"@site/docs/Services/Event_processing/Event_handling_Example_2_Queue_service_that_processes_input_events.md","sourceDirName":"Services/Event_processing","slug":"/Services/Event_processing/Event_handling_Example_2_Queue_service_that_processes_input_events","permalink":"/udocs/Services/Event_processing/Event_handling_Example_2_Queue_service_that_processes_input_events","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"Event_handling_Example_2_Queue_service_that_processes_input_events"},"sidebar":"sidebar","previous":{"title":"Event handling Example 1: Job that processes queued input events","permalink":"/udocs/Services/Event_processing/Event_handling_Example_1_Job_that_processes_queued_input_events"},"next":{"title":"Producing events","permalink":"/udocs/Services/Event_processing/Producing_events"}}');var r=s(74848),i=s(28453);const o={id:"Event_handling_Example_2_Queue_service_that_processes_input_events"},c="Event handling Example 2: Queue service that processes input events",a={},h=[{value:"Creating a queue service for processing input events asynchronously",id:"creating-a-queue-service-for-processing-input-events-asynchronously",level:2},{value:"Publishing the solution",id:"publishing-the-solution",level:2},{value:"Testing the implementation",id:"testing-the-implementation",level:2}];function l(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"event-handling-example-2-queue-service-that-processes-input-events",children:"Event handling Example 2: Queue service that processes input events"})}),"\n",(0,r.jsx)(n.p,{children:"The following step-by-step instructions are for creating a queue service that processes incoming reservation events for a Travel Agency model in an asynchronous fashion."}),"\n",(0,r.jsx)(n.p,{children:"The reservation events have already been stored in a queue table as an XML message. \xa0To make things easier, the event data in this example is in USoft's XML.Export format as applied to the Travel Agency's RESERVATION table."}),"\n",(0,r.jsx)(n.p,{children:"The queue table is called INPUT_QUEUE_RESERVATION. To define this queue table, see Example: REST service that receives events asynchronously."}),"\n",(0,r.jsx)(n.h2,{id:"creating-a-queue-service-for-processing-input-events-asynchronously",children:"Creating a queue service for processing input events asynchronously"}),"\n",(0,r.jsx)(n.p,{children:"To create a queue service for processing input events asynchronously:"}),"\n",(0,r.jsx)(n.p,{children:"1.\xa0In Service Definer, create a SQL statement that executes the processing job. Set the following values:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{}),(0,r.jsx)(n.th,{})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Statement name"}),(0,r.jsx)(n.td,{children:"PROCESS_QUEUE_RESERVATION"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Application Name"}),(0,r.jsx)(n.td,{children:"TRAVEL"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"Statement:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:'INVOKE   BatchRunner.PROCESS_QUEUE_RESERVATION WITH \nSELECT   :id      "MESSAGE_ID"\n,        \'True\'   "-quiet"\n'})}),"\n",(0,r.jsx)(n.p,{children:"Save work. Click the Check button to have your SQL syntax checked. If it is correct, the Correct = Yes flag is set."}),"\n",(0,r.jsx)(n.p,{children:"2.\xa0Choose Services, New Queue Service from the menu. In the dialog, set the following values:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{}),(0,r.jsx)(n.th,{})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Queue Service Name"}),(0,r.jsx)(n.td,{children:"process_reservation"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Application Name"}),(0,r.jsx)(n.td,{children:"TRAVEL"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Queue Table Name"}),(0,r.jsx)(n.td,{children:"INPUT_QUEUE_RESERVATION"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Selection Connection Name"}),(0,r.jsx)(n.td,{children:"queue_select"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Processing Connection Name"}),(0,r.jsx)(n.td,{children:"queue_process"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Process Statement Name"}),(0,r.jsx)(n.td,{children:"PROCESS_QUEUE_RESERVATION"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"3.\xa0Press OK. Notice that the following are offered in the Catalog on the left-hand side for inspection:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"a Service(Other) named process_reservation. \xa0"}),"\n",(0,r.jsx)(n.li,{children:"two Connections named queue_select and queue_process. Both connections have a default rules service added, using port 7777. Change this as needed. Both connections may use the same port number or different port numbers."}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsx)(n.p,{children:"You can also used the same connection name for Selection Connection Name and Process Connection Name. For administration reasons it might be easier to use different names, that may in fact use the Rules Service."})}),"\n",(0,r.jsx)(n.h2,{id:"publishing-the-solution",children:"Publishing the solution"}),"\n",(0,r.jsx)(n.p,{children:"To publish the solution:"}),"\n",(0,r.jsx)(n.p,{children:"1.\xa0Add the new queue service to your Server."}),"\n",(0,r.jsx)(n.p,{children:"2.\xa0Choose Define, Servers, and retrieve the record of the Server in which you want to expose the service."}),"\n",(0,r.jsx)(n.p,{children:"3.\xa0On the Properties tab, add the following properties:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"process_reservation#USoftPassword. Set the value to a user password known in Authorizer."}),"\n",(0,r.jsx)(n.li,{children:"process_reservation#USoftUser. Set the value to a user name known in Authorizer."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"4.\xa0Choose Publish and Restart from the menu."}),"\n",(0,r.jsx)(n.h2,{id:"testing-the-implementation",children:"Testing the implementation"}),"\n",(0,r.jsx)(n.p,{children:"To test the implementation:"}),"\n",(0,r.jsx)(n.p,{children:"1.\xa0Check that, after starting the Server, messages in the queue table that had not been processed ( Status field is NONE) are now processed successfully, or processed with error."}),"\n",(0,r.jsx)(n.p,{children:"2.\xa0Check that events that are received via a receive-events service (see REST service that receives events asynchronously) are immediately processed, either successfully or with error."})]})}function d(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>c});var t=s(96540);const r={},i=t.createContext(r);function o(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);