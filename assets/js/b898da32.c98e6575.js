"use strict";(self.webpackChunkudocs=self.webpackChunkudocs||[]).push([[74432],{1316:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>c,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"Services/USoft_Service_Definer_objects/Queue_Services","title":"Queue Services","description":"A queue service in Service Definer is a Service (Other) that allows you to read and/or process rows from a queue table defined in Definer a first-in-first-out order.","source":"@site/docs/Services/USoft_Service_Definer_objects/Queue_Services.md","sourceDirName":"Services/USoft_Service_Definer_objects","slug":"/Services/USoft_Service_Definer_objects/Queue_Services","permalink":"/udocs/Services/USoft_Service_Definer_objects/Queue_Services","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"Queue_Services"},"sidebar":"sidebar","previous":{"title":"Multiple connections and Rules Services","permalink":"/udocs/Services/USoft_Service_Definer_objects/Multiple_connections_and_Rules_Services"},"next":{"title":"Reroute mappings","permalink":"/udocs/Services/USoft_Service_Definer_objects/Reroute_mappings"}}');var i=n(74848),r=n(28453);const c={id:"Queue_Services"},o="Queue Services",d={},l=[{value:"Defining a queue service",id:"defining-a-queue-service",level:2},{value:"Queue service properties",id:"queue-service-properties",level:2},{value:"Queue service define-time properties",id:"queue-service-define-time-properties",level:2},{value:"Queue service runtime properties",id:"queue-service-runtime-properties",level:2}];function a(e){const s={admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"queue-services",children:"Queue Services"})}),"\n",(0,i.jsx)(s.p,{children:"A queue service in Service Definer is a Service (Other) that allows you to read and/or process rows from a queue table defined in Definer a first-in-first-out order."}),"\n",(0,i.jsx)(s.p,{children:"A queue table is a normal table defined in Definer that complies with the following rules:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"has a ID primary key column based on a generated sequence number"}),"\n",(0,i.jsx)(s.li,{children:"has a STATUS column based on a domain with at least one allowed value: 'NONE'"}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"defining-a-queue-service",children:"Defining a queue service"}),"\n",(0,i.jsx)(s.p,{children:"To define a queue service:"}),"\n",(0,i.jsx)(s.p,{children:"1.\xa0Choose Service, New Queue Service from the menu."}),"\n",(0,i.jsx)(s.p,{children:"2.\xa0Set the following values:"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{}),(0,i.jsx)(s.th,{})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Queue Service Name"}),(0,i.jsx)(s.td,{children:"(the name of the queue service)"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Application Name"}),(0,i.jsx)(s.td,{children:"the name of the USoft application where the queue table is defined)"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Queue Table Name"}),(0,i.jsx)(s.td,{children:"(the name of the queue table as defined in Definer)"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Selection Connection Name"}),(0,i.jsx)(s.td,{children:"(the name of the Service Definer connection that will be used to execute the selection on the queue table)."})]})]})]}),"\n",(0,i.jsx)(s.p,{children:"The default implementation of a queue service uses following select statement:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-sql",children:"SELECT \xa0 RECORDS(1, 50) id\nFROM \xa0 \xa0 queue-table\nWHERE \xa0 \xa0status = 'NONE' AND\n(\n \xa0 \xa0 \xa0 \xa0 :msgid is null \n \xa0 OR \xa0  id > :msgid\n)\nORDER BY id ASC\n\n"})}),"\n",(0,i.jsxs)(s.p,{children:["where ",(0,i.jsx)(s.strong,{children:":msgid"})," is the message id of the last selected row."]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"Processing Connection Name = (the name of the Service Definer connection that will be used to execute processing statement, that is Process Statement Name).\n"})}),"\n",(0,i.jsx)(s.p,{children:"Process Statement Name = (the name of the statement used for processing a row in the queue table)."}),"\n",(0,i.jsx)(s.p,{children:"3.\xa0A \xa0connection is added with the name specified by Selection Connection Name field, if it does not exists."}),"\n",(0,i.jsx)(s.p,{children:"The connection has a rule service with following properties:"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{}),(0,i.jsx)(s.th,{})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Host name"}),(0,i.jsx)(s.td,{children:"localhost"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Port number"}),(0,i.jsx)(s.td,{children:"7777"})]})]})]}),"\n",(0,i.jsx)(s.p,{children:"Change these settings as required."}),"\n",(0,i.jsx)(s.p,{children:"4.\xa0A \xa0connection is added for the value specified by Processing Connection Name field, if it does not exists."}),"\n",(0,i.jsx)(s.p,{children:"The connection has a rule service with following properties:"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{}),(0,i.jsx)(s.th,{})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Host name"}),(0,i.jsx)(s.td,{children:"localhost"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Port number"}),(0,i.jsx)(s.td,{children:"7777"})]})]})]}),"\n",(0,i.jsx)(s.p,{children:"Change these settings as required."}),"\n",(0,i.jsx)(s.admonition,{type:"note",children:(0,i.jsx)(s.p,{children:"You can also used the same connection name for Selection Connection Name and Process Connection Name. For administration reasons it might be easier to use different names, that may in fact use the Rules Service."})}),"\n",(0,i.jsx)(s.p,{children:"5.\xa0A statement is added with the name specified by Process Statement Name field if it does not exists, having following SQL Statement:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-sql",children:'INVOKE BatchRunner.PROCESS_QUEUE WITH SELECT :msgid "ID", \'True\' "-quiet"\n\n'})}),"\n",(0,i.jsx)(s.p,{children:"Change the default SQL Statement, or just the job name in the SQL Statement with the job in Definer that does the processing."}),"\n",(0,i.jsx)(s.p,{children:"6.\xa0Two properties are added to the global properties:"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{}),(0,i.jsx)(s.th,{})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"<queue service name>#USoftUser"}),(0,i.jsx)(s.td,{children:"USoft user name used to connect to the rule service defined in selection and processing connections"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"<queue service name>#USoftPassword"}),(0,i.jsx)(s.td,{children:"USoft password used to connect to the rule service defined in selection and processing connections"})]})]})]}),"\n",(0,i.jsx)(s.h2,{id:"queue-service-properties",children:"Queue service properties"}),"\n",(0,i.jsx)(s.p,{children:"Queue service is configured by properties. The properties are classified as:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Define time properties: properties that cannot be changed after the server is published"}),"\n",(0,i.jsx)(s.li,{children:"Runtime properties: properties that can be changed after the server is published."}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"After publication, runtime properties are available in the config.xml file of the server. They may be changed by a automatic release and configure procedure, or directly on the target machine where the server is running (acceptance, testing or production environment)."}),"\n",(0,i.jsx)(s.h2,{id:"queue-service-define-time-properties",children:"Queue service define-time properties"}),"\n",(0,i.jsx)(s.p,{children:"Define-time properties for a queue service are defined as properties in the @QueueTask annotation."}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.em,{children:"Example"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:'@QueueTask(name="message_queue", selectConnection="selectMQ", processConnection="processMQ", defaultGrouping="EXTERNAL_KEY")\n'})}),"\n",(0,i.jsx)(s.p,{children:"Define-time properties are:"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:(0,i.jsx)(s.strong,{children:"Property Name"})}),(0,i.jsx)(s.th,{children:(0,i.jsx)(s.strong,{children:"Description"})})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"name"}),(0,i.jsx)(s.td,{children:"The name of the queue table in Definer"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"selectConnection"}),(0,i.jsxs)(s.td,{children:[(0,i.jsx)("p",{children:"The name of the Service Definer connection that will be used to execute the selection on the queue table. The default implementation of a queue service uses following select statement:"}),(0,i.jsx)("pre",{children:(0,i.jsxs)("code",{class:"language-sql",children:["SELECT   RECORDS(1, 50) id",(0,i.jsx)("br",{}),"FROM     <queue table> ",(0,i.jsx)("br",{}),"WHERE    status = 'NONE' ",(0,i.jsx)("br",{}),"AND(",(0,i.jsx)("br",{}),"             ",":msgid"," is null ",(0,i.jsx)("br",{}),"      OR     id > ",":msgid",(0,i.jsx)("br",{}),")",(0,i.jsx)("br",{}),"ORDER BY id ASC"]})}),(0,i.jsxs)("p",{children:["where ",(0,i.jsx)(s.strong,{children:":msgid"})," is the message id of the last selected row."]})]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"processConnection"}),(0,i.jsx)(s.td,{children:"the name of the Service Definer connection that will be used to execute processing statement, that is the statement used in the Implementation of the onMessage method."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"defaultGrouping"}),(0,i.jsx)(s.td,{children:"A queue service may execute processing statements in parallel, using multiple rules engines.Rows in a queue table may be grouped using a field in the queue table, and it is useful if you want all rows from the queue table in a specific group to be processed serially. This property contains the name of the column in the queue table used for grouping. Messages are not grouped if defaultGrouping property is not declared."})]})]})]}),"\n",(0,i.jsx)(s.h2,{id:"queue-service-runtime-properties",children:"Queue service runtime properties"}),"\n",(0,i.jsx)(s.p,{children:"Runtime properties for a queue service are defined as properties on the Properties tab of the server where a queue service is published. The property names follow the syntax:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"<queue-service-name>.<property-name>\n\n"})}),"\n",(0,i.jsx)(s.admonition,{type:"warning",children:(0,i.jsx)(s.p,{children:"The following syntax is now obsolete:"})}),"\n",(0,i.jsx)(s.p,{children:"\xa0"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.em,{children:"Example"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"process_reservation.USoftUser\n\n"})}),"\n",(0,i.jsx)(s.p,{children:"Runtime properties are:"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:(0,i.jsx)(s.strong,{children:"Property Name"})}),(0,i.jsx)(s.th,{children:(0,i.jsx)(s.strong,{children:"Description"})})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"USoftUser"}),(0,i.jsx)(s.td,{children:"A user name defined in Authorizer; the user name part of the credentials used by the selection connection to select data from the queue table and for the processing connection to process data using the process statement."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"USoftPassword"}),(0,i.jsx)(s.td,{children:"The password part of the credentials used by the selection connection to select data from the queue table and for the processing connection to process data using the process statement."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"ParallelTasks"}),(0,i.jsxs)(s.td,{children:[(0,i.jsx)("p",{children:"The number of processing tasks that are allowed to execute in parallel. These tasks will be equally distributed over the number of Rules Services defined in the processing connection. The default is 1, meaning that serial processing is the default: tasks are not executed in parallel."}),(0,i.jsx)("p",{children:(0,i.jsx)(s.em,{children:"Examples"})}),(0,i.jsxs)("p",{children:["- The processing connection has 1 Rules Service and there are 4 parallel tasks to be executed. 4 Rules Engines will start on the Rules Service.",(0,i.jsx)("br",{}),"- The processing connection has 2 Rules Services and there are 4 parallel tasks to be executed. Each Rules Service will have 2 Rules Engines active.",(0,i.jsx)("br",{})]})]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"RetryInterval"}),(0,i.jsx)(s.td,{children:"If an error happens at processing time, this property sets the period in milliseconds that the queue service waits before the queue table row is offered again for processing. The default is 1000 (milliseconds)."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"RetryCount"}),(0,i.jsx)(s.td,{children:"If an error happens at processing time, this property sets the number of times that the queue service submits the queue table row for processing. The default is 3 (times)."})]})]})]}),"\n",(0,i.jsx)(s.p,{children:"\xa0"})]})}function h(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},28453:(e,s,n)=>{n.d(s,{R:()=>c,x:()=>o});var t=n(96540);const i={},r=t.createContext(i);function c(e){const s=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),t.createElement(r.Provider,{value:s},e.children)}}}]);