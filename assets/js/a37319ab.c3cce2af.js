"use strict";(self.webpackChunkudocs=self.webpackChunkudocs||[]).push([[17826],{28453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>r});var s=i(96540);const t={},o=s.createContext(t);function l(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(o.Provider,{value:n},e.children)}},40570:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"Extensions/USFile_internal_component/USFileOpen","title":"USFile.Open","description":"This article is about the Open method of the USFile internal component.","source":"@site/docs/Extensions/USFile_internal_component/USFileOpen.md","sourceDirName":"Extensions/USFile_internal_component","slug":"/Extensions/USFile_internal_component/USFileOpen","permalink":"/udocs/Extensions/USFile_internal_component/USFileOpen","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"USFileOpen"},"sidebar":"sidebar","previous":{"title":"USFile.EOF","permalink":"/udocs/Extensions/USFile_internal_component/USFileEOF"},"next":{"title":"USFile.ReadBinaryFile","permalink":"/udocs/Extensions/USFile_internal_component/USFileReadBinaryFile"}}');var t=i(74848),o=i(28453);const l={id:"USFileOpen"},r="USFile.Open",a={},d=[{value:"<strong>USFile.Open</strong>",id:"usfileopen-1",level:2},{value:"Errors",id:"errors",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"usfileopen",children:"USFile.Open"})}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["This article is about the ",(0,t.jsx)(n.strong,{children:"Open"})," method of the ",(0,t.jsx)(n.a,{href:"/Extensions/USFile_internal_component",children:"USFile internal component"}),"."]})}),"\n",(0,t.jsx)(n.h2,{id:"usfileopen-1",children:(0,t.jsx)(n.strong,{children:"USFile.Open"})}),"\n",(0,t.jsxs)(n.p,{children:["Opens a file for reading, writing, or appending. Assigns an alias to the opened file. This alias can then be used in successive calls to the USFile component. The alias can also be used by the ",(0,t.jsx)(n.strong,{children:"XML.Export"})," method."]}),"\n",(0,t.jsx)(n.p,{children:"Opens a connection to a file for subsequent reading or writing. If the file is successfully opened, the alias is returned. If a failure occurs, an error message is returned."}),"\n",(0,t.jsxs)(n.p,{children:["When you have finished reading from or writing to a file that was successfully opened, close it by using the ",(0,t.jsx)(n.strong,{children:"USFile.Close"})," method."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"Syntax"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:'INVOKE USFile.Open WITH\nSELECT     *alias*\n,          *filename*\n,          *mode*        "Mode"\n,          *encoding*    Encoding\n\n*alias*     :=  { USFile.*string* | *string* }\n*mode*      :=  { APPEND | READ | WRITE }\n*encoding*  :=  { UTF-8 | ASCII | UTF16LE }\n'})}),"\n",(0,t.jsxs)(n.p,{children:["The required and case-insensitive ",(0,t.jsx)(n.em,{children:"alias"})," acts as a handle for identifying the opened file in subsequent calls. ",(0,t.jsx)(n.em,{children:"Alias"}),' optionally starts with a prefix that is the string "USFILE" (case-insensitively) followed by a full stop (\xa0.\xa0). For consistency, best practice is to use the prefix in all calls to USFile.Open(). (For some methods such as USFile.ReadLine() it does not make a difference whether you use the prefix. For others, such as USFile.ReadTextFile(), the alias is interpreted as a file handle if the prefix is present and as a filepath if the prefix is absent.)']}),"\n",(0,t.jsxs)(n.p,{children:["The required ",(0,t.jsx)(n.em,{children:"filename"})," specifies the folderpath and filename of the text file to be opened. This name is allowed to contain environment variables."]}),"\n",(0,t.jsxs)(n.p,{children:["The required ",(0,t.jsx)(n.em,{children:"mode"})," is the mode in which the file is opened. Possible values are READ, WRITE and the default APPEND. Use READ to read from the opened file. Use APPEND or WRITE to write to the opened file. If you use WRITE, the existing contents of the file (if any) are lost."]}),"\n",(0,t.jsx)(n.admonition,{type:"danger",children:(0,t.jsx)(n.p,{children:'The optional column alias "Mode" must be surrounded by double quotes if "Mode" is a SQL keyword on your database platform. Otherwise, double quotes around column aliases are optional.'})}),"\n",(0,t.jsx)(n.p,{children:"The optional encoding is effective only if mode is APPEND and the external file does not yet exist, or if mode is WRITE. If mode is APPEND and the external file exists, or if mode is READ, the existing encoding of the file applies. Possible values for encoding are: UTF-8 (the recommended default), ASCII, and UTF16LE (= UTF-16 Little Endian)."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"Example"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"INVOKE    USFile.Open WITH\nSELECT    'USFile.ToursFile'\n,         '%TEMP%\\MyToursFile.txt'\n,         'WRITE'   \"Mode\"\n,         'ASCII'   Encoding\n"})}),"\n",(0,t.jsx)(n.h2,{id:"errors",children:"Errors"}),"\n",(0,t.jsxs)(n.p,{children:["If you call the USFile.Open repeatedly without an intervening call to ",(0,t.jsx)(n.strong,{children:"USFile.Close"}),', the second and subsequent calls lead to an error ("The alias is already in use").']}),"\n",(0,t.jsx)(n.p,{children:"\xa0"})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}}}]);