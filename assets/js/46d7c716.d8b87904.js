"use strict";(self.webpackChunkudocs=self.webpackChunkudocs||[]).push([[44409],{28453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>s});var r=n(96540);const o={},i=r.createContext(o);function a(e){const t=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),r.createElement(i.Provider,{value:t},e.children)}},86519:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>s,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"Desktop_UIs/Exploring_USoft_Windows_Designer/Extra_Queries","title":"Extra Queries","description":"In addition to data retrieved by its main query, an info box may show data from extra queries. There are many use cases for extra queries. Here are two examples:","source":"@site/docs/Desktop_UIs/Exploring_USoft_Windows_Designer/Extra_Queries.md","sourceDirName":"Desktop_UIs/Exploring_USoft_Windows_Designer","slug":"/Desktop_UIs/Exploring_USoft_Windows_Designer/Extra_Queries","permalink":"/udocs/Desktop_UIs/Exploring_USoft_Windows_Designer/Extra_Queries","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"Extra_Queries"},"sidebar":"sidebar","previous":{"title":"Joined Columns","permalink":"/udocs/Desktop_UIs/Exploring_USoft_Windows_Designer/Joined_Columns"},"next":{"title":"Class hierarchy of info boxes","permalink":"/udocs/Desktop_UIs/Exploring_USoft_Windows_Designer/Class_hierarchy_of_info_boxes"}}');var o=n(74848),i=n(28453);const a={id:"Extra_Queries"},s="Extra Queries",d={},c=[{value:"How to add an Extra Query",id:"how-to-add-an-extra-query",level:3},{value:"Extra Query Example 1: Dynamic Background Color Change",id:"extra-query-example-1-dynamic-background-color-change",level:3},{value:"Extra Query Example 2: Child Box Background Color Dependent on Parent Data",id:"extra-query-example-2-child-box-background-color-dependent-on-parent-data",level:3},{value:"Extra Queries for related information",id:"extra-queries-for-related-information",level:3},{value:"Computed values in Extra Queries",id:"computed-values-in-extra-queries",level:3}];function l(e){const t={admonition:"admonition",code:"code",em:"em",h1:"h1",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"extra-queries",children:"Extra Queries"})}),"\n",(0,o.jsxs)(t.p,{children:["In addition to data retrieved by its main query, an info box may show data from ",(0,o.jsx)(t.strong,{children:"extra queries"}),". There are many use cases for extra queries. Here are two examples:"]}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsx)(t.p,{children:"The extra query performs a calculation using related information from other tables. You can show the calculation result in a field of the info box where the extra query is defined."}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsx)(t.p,{children:"The extra query finds out something from other tables that you need to make a GUI control (a tab, a button...) sensitive or insensitive in the info box where the extra query is defined."}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(t.p,{children:"A single extra query definition may result in one or multiple displayed or computed or hidden fields."}),"\n",(0,o.jsx)(t.p,{children:"If you use more than one extra query in the same info box, execution order between extra queries cannot be specified. For this reason, you cannot refer to one extra query in the SQL statement of another. To control execution order, use Decisions instead."}),"\n",(0,o.jsx)(t.p,{children:"Extra Queries are also executed when you enter Query Mode. If a No Action has been specified for the Extra Query (see the first 2 examples in this help topic), then this No action will be performed when you enter Query Mode."}),"\n",(0,o.jsx)(t.admonition,{type:"tip",children:(0,o.jsx)(t.p,{children:"To create an extra field in your info box that represents joined data from a parent table or grandparent table, insert a joined column instead."})}),"\n",(0,o.jsx)(t.h3,{id:"how-to-add-an-extra-query",children:"How to add an Extra Query"}),"\n",(0,o.jsx)(t.p,{children:"To add an Extra Query:"}),"\n",(0,o.jsx)(t.p,{children:"1.Use the Windows Designer catalog to open the appropriate window/dialog."}),"\n",(0,o.jsx)(t.p,{children:"2.In the design view, select the Info Box into which you want to insert an extra query."}),"\n",(0,o.jsx)(t.p,{children:"3.From the menu bar, choose Insert, Extra Query."}),"\n",(0,o.jsx)(t.p,{children:"A dummy Extra Query and its resulting field are inserted."}),"\n",(0,o.jsx)(t.p,{children:"4.Select the Extra Query in the Object Tree for the window/dialog, and open the Property Inspector."}),"\n",(0,o.jsx)(t.admonition,{type:"note",children:(0,o.jsx)(t.p,{children:"Do NOT specify the underlying query by selecting the dummy field and setting its Values property. This does not produce the desired result."})}),"\n",(0,o.jsx)(t.p,{children:"5.In the Property Inspector, select the Underlying Query property and press the upper Edit (...) button."}),"\n",(0,o.jsx)(t.p,{children:"The SQL Definer opens, enabling you to specify the query."}),"\n",(0,o.jsx)(t.p,{children:"6.Specify the Underlying Query statement. On the Query Tree tab page, select Save from the right mouse-menu. Close the SQL Definer."}),"\n",(0,o.jsx)(t.p,{children:"One or more extra column controls are added to the current info box to display the extra query result. Use the Property Inspector to change their location and display properties. Prompts are taken from the select list of the extra query's SQL statement."}),"\n",(0,o.jsx)(t.p,{children:"7.Save your changes."}),"\n",(0,o.jsx)(t.h3,{id:"extra-query-example-1-dynamic-background-color-change",children:"Extra Query Example 1: Dynamic Background Color Change"}),"\n",(0,o.jsx)(t.p,{children:"Prices over 1600 should be highlighted in red. Otherwise the Price text box should have a blue background."}),"\n",(0,o.jsx)(t.p,{children:"Insert an Extra Query into the info box, and set the following properties for it:"}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.em,{children:"SQL Statement"})}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"price > 1600\n"})}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.em,{children:"Yes Action"})}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"Variables.price.background('red')\n"})}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.em,{children:"No Action"})}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"Variables.price.background('blue')\n"})}),"\n",(0,o.jsx)(t.p,{children:"Alternatively, you can set the Yes Action and No Action properties using the Object Activator. In this case, do not use the Client property. Select the data control as a part of each of the action statements."}),"\n",(0,o.jsx)(t.p,{children:"When you insert an extra query, a column control with prompt 'x' is automatically displayed for its outcome. In this case, you want to make this control non-displayed."}),"\n",(0,o.jsx)(t.h3,{id:"extra-query-example-2-child-box-background-color-dependent-on-parent-data",children:"Extra Query Example 2: Child Box Background Color Dependent on Parent Data"}),"\n",(0,o.jsx)(t.p,{children:"The Reservations info window by default contains a Participants detail box because reservations cannot exist without participants. Suppose you want participant records grayed out if a reservation is canceled. You will have to define an action to make this happen, and a search specification to refer to the control you want the action to operate on."}),"\n",(0,o.jsx)(t.p,{children:"To gray out participant records when reservation is canceled:"}),"\n",(0,o.jsx)(t.p,{children:"1.Select the Reservations info window."}),"\n",(0,o.jsx)(t.p,{children:"Make sure you select the Info Window itself and not one of its components. The status line should read Info Window: Reservations."}),"\n",(0,o.jsx)(t.p,{children:"2.From the menu bar, choose Insert, Extra Query."}),"\n",(0,o.jsx)(t.p,{children:"A query object and a visible extra query control are created."}),"\n",(0,o.jsx)(t.p,{children:"3.From the menu bar, choose Design, Extra Query to navigate to the query object (NOT the visible text box), or use the Object tree."}),"\n",(0,o.jsx)(t.p,{children:"4.Set property SQL Statement, on the General tab page to:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"SELECT 'x' FROM RESERVATION\nWHERE CANCEL_DATE IS NOT NULL\n\n"})}),"\n",(0,o.jsx)(t.p,{children:"5.Set property Yes Action on the Behavior tab page to:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"Participants_taking_part_in_Reservation.insertable('No')\nParticipants_taking_part_in_Reservation.updatable('No')\n\n"})}),"\n",(0,o.jsx)(t.p,{children:"6.Set property No Action on the Behavior tab page to:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"Participants_taking_part_in_Reservation.insertable('Yes')\nParticipants_taking_part_in_Reservation.updatable('Yes')\n\n"})}),"\n",(0,o.jsx)(t.p,{children:"7.Run the info window to test the new functionality. Query all records."}),"\n",(0,o.jsx)(t.p,{children:"8.If you are satisfied, close the runtime window and save the design work."}),"\n",(0,o.jsx)(t.p,{children:"9.To make the extra query column non-displayed, select the column. Make sure that the status bar indicates the column control, e.g. \" esd_char: 'x' \". Set property Displayed on the General tab page to No."}),"\n",(0,o.jsx)(t.h3,{id:"extra-queries-for-related-information",children:"Extra Queries for related information"}),"\n",(0,o.jsx)(t.p,{children:"You may show related information from other database objects in the box for a particular database object by defining an extra query for it. This extra query must be able to retrieve the appropriate value for each record in the box, and contain a join of at least the database object on which the box is based and the database object from which the related information is retrieved."}),"\n",(0,o.jsx)(t.admonition,{type:"note",children:(0,o.jsx)(t.p,{children:'For standard "lookup fields" reproducing a value from a parent table in a child window, use joined columns. Joined columns are defined at column level in USoft Definer.'})}),"\n",(0,o.jsx)(t.p,{children:'If you want the Tours window in the Travel Agency system to have an "additional field" showing the start date and end date for each tour, you must provide that window with the following extra query:'}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"SELECT \xa0 c.start_date || ' , ' || c.end_date\nFROM \xa0 \xa0 schedtour_c, tour\nRELATE \xa0 c \"SUBJECT TO\" h\n\n\n"})}),"\n",(0,o.jsx)(t.p,{children:"If you want to provide it with an alternative prompt, you may add it to the underlying query as a display label (i.e. prompt):"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:'SELECT \xa0 c.start_date || \' , \' || c.end_date "Your Prompt"\nFROM \xa0 \xa0 schedtour_c, tour\nRELATE \xa0 c "SUBJECT TO" h\n\n'})}),"\n",(0,o.jsx)(t.h3,{id:"computed-values-in-extra-queries",children:"Computed values in Extra Queries"}),"\n",(0,o.jsx)(t.p,{children:"You may use extra queries to show the result of computations. Using this facility, you may display the number of computers of a particular model, for example. That is, use the extra query to compute a value for each visible record in a box."}),"\n",(0,o.jsx)(t.p,{children:"To compute the number of tours that last a particular number of days, you may write the following query:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:'SELECT \xa0 COUNT(num_days) "Number of days"\nFROM \xa0 \xa0 FROM \xa0 \xa0 schedtour_c, tour\nRELATE \xa0 c "SUBJECT TO" h\n\n'})}),"\n",(0,o.jsx)(t.p,{children:"As the query is performed once for each record in the box, you do not need a GROUP BY clause."}),"\n",(0,o.jsx)(t.p,{children:'USoft Developer cannot retrieve a field prompt for this field from the repository. If you do not provide one yourself, it uses "COUNT(num_days)".'})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}}}]);