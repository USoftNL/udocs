"use strict";(self.webpackChunkudocs=self.webpackChunkudocs||[]).push([[12660],{28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>o});var s=t(96540);const r={},i=s.createContext(r);function a(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(i.Provider,{value:n},e.children)}},84046:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"Modeller_and_Rules_Engine/Constraints_advanced_and_the_Rules_Engine/Constraint_key_query","title":"Constraint key query","description":"At store-record time, in an operation known as a constraint key query, the Rules Engine may attempt to get primary key information of records being processed. This is because database values needed during later transaction checks will be retrieved faster if primary key values can be used.","source":"@site/docs/Modeller_and_Rules_Engine/Constraints_advanced_and_the_Rules_Engine/Constraint_key_query.md","sourceDirName":"Modeller_and_Rules_Engine/Constraints_advanced_and_the_Rules_Engine","slug":"/Modeller_and_Rules_Engine/Constraints_advanced_and_the_Rules_Engine/Constraint_key_query","permalink":"/udocs/Modeller_and_Rules_Engine/Constraints_advanced_and_the_Rules_Engine/Constraint_key_query","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"Constraint_key_query"},"sidebar":"sidebar","previous":{"title":"Driving table","permalink":"/udocs/Modeller_and_Rules_Engine/Constraints_advanced_and_the_Rules_Engine/Driving_table"},"next":{"title":"Transaction checklist signals","permalink":"/udocs/Modeller_and_Rules_Engine/Constraints_advanced_and_the_Rules_Engine/Transaction_checklist_signals"}}');var r=t(74848),i=t(28453);const a={id:"Constraint_key_query"},o="Constraint key query",d={},c=[];function l(e){const n={code:"code",em:"em",h1:"h1",header:"header",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"constraint-key-query",children:"Constraint key query"})}),"\n",(0,r.jsxs)(n.p,{children:["At store-record time, in an operation known as a ",(0,r.jsx)(n.em,{children:"constraint key query,"})," the Rules Engine may attempt to get primary key information of records being processed. This is because database values needed during later transaction checks will be retrieved faster if primary key values can be used."]}),"\n",(0,r.jsx)(n.p,{children:"Constraint key queries are identified in BenchMark profiler output as having Reason = CONSTRAINT_KEYQUERY."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.em,{children:"Example"})}),"\n",(0,r.jsx)(n.p,{children:'A business rule: "A guide cannot guide more than one tour at the same time" is implemented by a restrictive constraint:'}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"SELECT \xa0 \xa0'' violation\nFROM \xa0 \xa0 \xa0schedtour st1\n, \xa0 \xa0 \xa0 \xa0 schedtour st2\nWHERE \xa0 \xa0 st1.guide = st2.guide\nAND \xa0 \xa0 \xa0 st1.schedtour_id != st2.schedtour_id\nAND \xa0 \xa0 \xa0 st1.start_date BETWEEN st2.start_date AND st2.return_date\n"})}),"\n",(0,r.jsx)(n.p,{children:"In this constraint, there is no join based on relationship columns (because there is no relationship). When a manipulation takes place on the SCHEDTOUR table, a constraint key query is issued to retrieve the primary key values of the driving table (SCHEDTOUR st1). These primary key values are substituted during the transaction check at commit time:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"SELECT \xa0 \xa0t1.SCHEDTOUR_ID\nFROM \xa0 \xa0 \xa0OPS$CP2.SCHEDTOUR t1\nWHERE \xa0 \n(\n \xa0 \xa0 \xa0 \xa0 \xa0t1.GUIDE = TO_NUMBER(:1)\n \xa0 AND \xa0 \xa0t1.SCHEDTOUR_ID <> TO_NUMBER(:2)\n \xa0 AND \xa0 \xa0t1.START_DATE BETWEEN\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0TO_DATE(:3, 'SYYYY/MMDDHH24MISS') AND\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0TO_DATE(:4, 'SYYYY/MMDDHH24MISS')\n)\n(5,127,2000/0101000000,2000/0101000000)\n"})}),"\n",(0,r.jsx)(n.p,{children:"This check will now perform much faster than without the primary key information."})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}}}]);