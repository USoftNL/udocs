"use strict";(self.webpackChunkudocs=self.webpackChunkudocs||[]).push([[11278],{5828:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"Desktop_UIs/Scripting_in_USoft_Windows_Designer/FORMULA","title":"FORMULA()","description":"In action statement syntax (i.e. in places where SQL syntax is not expected), the FORMULA() application method subjects values to operations that require SQL evaluation.","source":"@site/docs/Desktop_UIs/Scripting_in_USoft_Windows_Designer/FORMULA.md","sourceDirName":"Desktop_UIs/Scripting_in_USoft_Windows_Designer","slug":"/Desktop_UIs/Scripting_in_USoft_Windows_Designer/FORMULA","permalink":"/udocs/Desktop_UIs/Scripting_in_USoft_Windows_Designer/FORMULA","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"FORMULA"},"sidebar":"sidebar","previous":{"title":"Action scripting and SQL","permalink":"/udocs/Desktop_UIs/Scripting_in_USoft_Windows_Designer/Action_scripting_and_SQL"},"next":{"title":"Actions Example 1: Automatic query","permalink":"/udocs/Desktop_UIs/Scripting_in_USoft_Windows_Designer/Actions_Example_1_Automatic_query"}}');var i=t(74848),a=t(28453);const r={id:"FORMULA"},o="FORMULA()",c={},l=[];function d(e){const n={code:"code",em:"em",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"formula",children:"FORMULA()"})}),"\n",(0,i.jsx)(n.p,{children:"In action statement syntax (i.e. in places where SQL syntax is not expected), the FORMULA() application method subjects values to operations that require SQL evaluation."}),"\n",(0,i.jsx)(n.p,{children:"Use FORMULA() outside SQL, i.e. in action statement syntax, to:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Subject values to scalar SQL functions such as ROUND(), SUBSTR() and so on."}),"\n",(0,i.jsx)(n.li,{children:"Subject numerical values to complex mathematical operations."}),"\n",(0,i.jsx)(n.li,{children:"Concatenate string values."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"The FORMULA() method is an embedded action statement that returns a string value to the embedding action statement. It takes string parameters that are either surrounded by single quotes, or represented by embedded action statements returning a string value."}),"\n",(0,i.jsx)(n.p,{children:"You can use any SQL syntax supported by your database vendor. To keep your USoft application portable between databases, however, you should adhere to standards. This is particularly a concern when calling SQL functions. USoft converts certain key SQL functions automatically between databases. Others are database-specific. Please refer to USoft Definer Help for details."}),"\n",(0,i.jsx)(n.p,{children:"In the Object Activator, a special Formula button helps you write FORMULA() expressions more easily."}),"\n",(0,i.jsx)(n.p,{children:"Other ways of using SQL where action statements are expected are to call the SqlScript() method, or to call ActionDecision() and retrieve data in the Decision SQL. Use SqlScript() to manipulate data in database tables, and Decisions to retrieve data from database tables."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Example 1"})}),"\n",(0,i.jsx)(n.p,{children:"This example reads an on-screen file name value currently held by a base column control, and concatenates it with a .TXT file name extension. The file name is a string value returned by an embedded action statement. The file extension is a hard-coded string."}),"\n",(0,i.jsx)(n.p,{children:"The first parameter represents the SQL expression in which one or more values take part. The second, third, etc. parameters represent the values themselves. The first parameter uses placeholders (:1, :2 and so on) to position the values within the SQL expression."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"FORMULA(':1 || :2',query.file_name(),'.TXT')\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Example 2"})}),"\n",(0,i.jsx)(n.p,{children:"This example reads an on-screen email address value currently held by a base column control, strips it down to the domain name (the part of the address after the '@' symbol), and prefixes it with the text \"Domain =\"."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"FORMULA(':1 || SUBSTR(:2,INSTR(:2,:3)+1)',\n'Domain = ', query.email(), '@')\n\n"})}),"\n",(0,i.jsx)(n.p,{children:"The resulting return value could be used in a message:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"MessageInformation(\n \xa0 FORMULA(\n \xa0 \xa0 \xa0':1 || SUBSTR(:2,INSTR(:2,:3)+1)'\n \xa0 , \xa0'Domain = '\n \xa0 , \xa0query.email()\n \xa0 , '@'\n \xa0 )\n)\n\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Example 3"})}),"\n",(0,i.jsx)(n.p,{children:"A decision gets a total and in the Yes Action, composes a message that uses this total:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Decision SQL"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"SELECT \xa0 SUM( salary )\nFROM \xa0 \xa0 emp\nWHERE \xa0 \xa0deptno = :DEPTNO\n\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Yes Action"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"MessageInformation(\n \xa0FORMULA(\n \xa0 \xa0 ':1 || :2'\n \xa0, \xa0'Total salary for this department is '\n \xa0, \xa0:1\n \xa0)\n)\n\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Example 4"})}),"\n",(0,i.jsx)(n.p,{children:"This example shows the use of FORMULA in an action script to calculate a date, and illustrates some guidelines to calculate a date using FORMULA:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Explicitly use TO_DATE to format the date in USoft's standard IO format, then calculate the date using an argument"}),"\n",(0,i.jsx)(n.li,{children:"Afterwards, use TO_CHAR to format the date back as you wish"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"QueryDefine( \xa0)\nquery.start_date( FORMULA( ''>'||TO_CHAR(TO_DATE(:1,'YYYY/MMDDHH24MISS'),'DD-MM-YYYY')', \xa0myStartDate() ) )\nquery.return_date( FORMULA( ''<'||TO_CHAR(TO_DATE(:1,'YYYY/MMDDHH24MISS')+:2,'DD-MM-YYYY')', \xa0myStartDate(), \xa0myNumberOfDays() ) )\nQueryExecute( \xa0)\n\n"})}),"\n",(0,i.jsx)(n.p,{children:"Refer to Action Example 9 to view this example in its full context."})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>o});var s=t(96540);const i={},a=s.createContext(i);function r(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);