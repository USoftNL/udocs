"use strict";(self.webpackChunkudocs=self.webpackChunkudocs||[]).push([[4277],{28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>a});var o=t(96540);const s={},i=o.createContext(s);function r(e){const n=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),o.createElement(i.Provider,{value:n},e.children)}},37263:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"Extensions/DotNet_components/C_components","title":"C# components","description":"components","source":"@site/docs/Extensions/DotNet_components/C_components.md","sourceDirName":"Extensions/DotNet_components","slug":"/Extensions/DotNet_components/C_components","permalink":"/udocs/Extensions/DotNet_components/C_components","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"C_components"},"sidebar":"sidebar","previous":{"title":"DotNet (.NET) components","permalink":"/udocs/Extensions/DotNet_components/DotNet_NET_components"},"next":{"title":"Nugets","permalink":"/udocs/Extensions/DotNet_components/Nugets"}}');var s=t(74848),i=t(28453);const r={id:"C_components"},a="C# components",c={},l=[{value:"Defining a C# component",id:"defining-a-c-component",level:2},{value:"Defining a C# component by starting from a generated stub",id:"defining-a-c-component-by-starting-from-a-generated-stub",level:3},{value:"Defining a C# component by starting from C# code",id:"defining-a-c-component-by-starting-from-c-code",level:3},{value:"Assembly References",id:"assembly-references",level:2},{value:"Referencing other components in Assembly References",id:"referencing-other-components-in-assembly-references",level:3},{value:"Environment variables in assembly references",id:"environment-variables-in-assembly-references",level:3},{value:"Having referenced nuget packages installed automatically",id:"having-referenced-nuget-packages-installed-automatically",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"c-components",children:"C# components"})}),"\n",(0,s.jsxs)(n.p,{children:["A \xa0",(0,s.jsx)(n.strong,{children:"C# component"})," is an RDMI component for which the Program Source is expressed in the C# language."]}),"\n",(0,s.jsx)(n.h2,{id:"defining-a-c-component",children:"Defining a C# component"}),"\n",(0,s.jsx)(n.p,{children:"You can define a C# component in 2 different ways:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"By starting from a generated stub. You provide name, method and parameters. USoft automatically generates and compiles a C# stub that you can then customise."}),"\n",(0,s.jsx)(n.li,{children:"By starting from C# code. You provide C# Program Code. USoft compiles the code for you."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"defining-a-c-component-by-starting-from-a-generated-stub",children:"Defining a C# component by starting from a generated stub"}),"\n",(0,s.jsx)(n.p,{children:"This example shows how you can define, by having a stub generated, a C# component that retrieves the value of an environment variable of which you pass the name."}),"\n",(0,s.jsx)(n.p,{children:'1.\xa0In USoft Definer, from the menu, choose Define, RDMI, dotNet Components, C# Components from the Define menu. The "C#t Components" window opens.'}),"\n",(0,s.jsx)(n.p,{children:"2.\xa0Set Name = ENV."}),"\n",(0,s.jsx)(n.p,{children:"3.\xa0Define a Method (in the empty record on the Methods tab). For this method, set Method = GET. Set Physical Method = getValue."}),"\n",(0,s.jsx)(n.p,{children:"4.\xa0Define two Parameters (in the empty related box headed Parameters, for the GET Method):"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"Seqno"})}),(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"Name"})}),(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"Mode"})}),(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"Data Type"})})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"name"}),(0,s.jsx)(n.td,{children:"In\xa0"}),(0,s.jsx)(n.td,{children:"String"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"1"}),(0,s.jsx)(n.td,{children:"Return_from_getValue"}),(0,s.jsx)(n.td,{children:"Return"}),(0,s.jsx)(n.td,{children:"String"})]})]})]}),"\n",(0,s.jsx)(n.p,{children:"5.\xa0Press Commit. USoft generates the C# stub in the Program Source field and it compiles this code."}),"\n",(0,s.jsx)(n.p,{children:'6.\xa0USoft has now generated a new class with the same name as the component name (ENV) and a method with the same name as the physical method(getvalue). The method has the same number and types of parameters as defined in the RDMI definition. The last thing you need to define is the implementation for this method. Change the default "OK" string to:'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Environment.GetEnvironmentVariable(name)\n"})}),"\n",(0,s.jsx)(n.p,{children:"The Program Source code should now look like this:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-language-cs",children:"using System;\nusing System.Text;\n\nclass ENV\n{\n\n   public static String getValue(String name)\n   {\n      return Environment.GetEnvironmentVariable(name);\n   }\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:'7.\xa0Commit changes. At runtime, when the .NET component is called, USoft compiles the source code ("just in time" (JIT) compilation), creates an instance of the class according to the component lifetime settings, and executes the method call. Here is an example call:'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"select env.get('windir')\n"})}),"\n",(0,s.jsx)(n.h3,{id:"defining-a-c-component-by-starting-from-c-code",children:"Defining a C# component by starting from C# code"}),"\n",(0,s.jsx)(n.p,{children:"This example shows how you can define, by starting from C# code that you already have, a C# component that retrieves the value of an environment variable of which you pass the name."}),"\n",(0,s.jsx)(n.p,{children:'1.\xa0In USoft Definer, from the menu, choose Define, RDMI, dotNet Components, C# Components from the Define menu. The "C#t Components" window opens.'}),"\n",(0,s.jsx)(n.p,{children:"2.\xa0Set Name = ENV."}),"\n",(0,s.jsxs)(n.ol,{start:"3",children:["\n",(0,s.jsx)(n.li,{children:"In the Program Source field, paste this code:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-language-cs",children:"using System;\nusing System.Text;\n\nclass ENV\n{\n\n   public static String getValue(String name)\n   {\n      return Environment.GetEnvironmentVariable(name);\n   }\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"3.\xa0Commit work."}),"\n",(0,s.jsx)(n.p,{children:"4.\xa0Press the Check button in the top right corner. In the question box, choose the Yes button."}),"\n",(0,s.jsx)(n.p,{children:"5.\xa0See that methods and parameters have been generated. To see this, click in the Method field on the Methods tab at the bottom of the window, and scroll down. A constructor method (here, with name ENV) may or may not be apparent. In addition, a method with name GETVALUE and 2 parameters has been generated."}),"\n",(0,s.jsx)(n.p,{children:'6.\xa0You are now ready to call the GETVALUE method. At runtime, when the .NET component is called, USoft compiles the source code ("just in time" (JIT) compilation), creates an instance of the class according to the component lifetime settings, and executes the method call. Here is an example call:'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"select env.getvalue('windir')\n"})}),"\n",(0,s.jsx)(n.h2,{id:"assembly-references",children:"Assembly References"}),"\n",(0,s.jsx)(n.p,{children:"The Assembly References property of a C# component specifies other C# components or libraries that must be included for the component to work properly."}),"\n",(0,s.jsx)(n.p,{children:"When you have your C# component checked, it will only be set to Correct = Yes if all the referenced components and libraries are found."}),"\n",(0,s.jsx)(n.h3,{id:"referencing-other-components-in-assembly-references",children:"Referencing other components in Assembly References"}),"\n",(0,s.jsx)(n.p,{children:"When you reference a package directly by \u201c.dll\u201d name, the dll is searched in the \\bin64 subfolder of your USoft installation folder:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"MyPackage.dll\n"})}),"\n",(0,s.jsx)(n.p,{children:"Alternatively, you can provide an absolute filepath:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"C:/temp/mypackages/mypackage.dll\n"})}),"\n",(0,s.jsx)(n.p,{children:'Alternatively, to include a C# component or other .NET component, you can reference it by literal component name. The component is found if it is listed as a "C# Component\u201d in the Definer catalog:'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"MyCSharpComponent \n"})}),"\n",(0,s.jsx)(n.p,{children:"Alternatively, you can reference a nuget package by its package name together with the version you intend to reference. The package version is searched in the dotnet.packages subfolder of your USoft installation folder:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"MyNugetPackage\\1.0.0\n"})}),"\n",(0,s.jsx)(n.p,{children:"You can omit the version, but this is not generally recommended. If you omit the version, the latest available version is selected:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"MyNugetPackage\n"})}),"\n",(0,s.jsx)(n.h3,{id:"environment-variables-in-assembly-references",children:"Environment variables in assembly references"}),"\n",(0,s.jsx)(n.p,{children:"Assembly references in C# components can use environment variables declared on the system.\nRefer to the environment variable by having its name wrapped in percent (%) symbols."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"Example"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"%MY_DUMMY_PATH%\\MyDummy.dll\n"})}),"\n",(0,s.jsx)(n.p,{children:"where MY_DUMMY_PATH is declared on the system environment variable list."}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsx)(n.p,{children:"This feature could be helpful when a component needs to be checked in a Windows Definer but is then run in a Docker container, where surely file paths are different. This nuisance is overcome by using environment variables."})}),"\n",(0,s.jsx)(n.h3,{id:"having-referenced-nuget-packages-installed-automatically",children:"Having referenced nuget packages installed automatically"}),"\n",(0,s.jsxs)(n.p,{children:["You can ",(0,s.jsx)(n.a,{href:"/udocs/Extensions/DotNet_components/Nugets",children:"have referenced nuget packages installed automatically"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);