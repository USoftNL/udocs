"use strict";(self.webpackChunkudocs=self.webpackChunkudocs||[]).push([[2395],{22889:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>d,frontMatter:()=>a,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"Services/USoft_Service_Definer_objects/Structures","title":"Structures","description":"A structure is, in functional terms, a named list of fields that correspond to data with specific format characteristics. For example, a structure called \\"CustomerDetails\\" could have the following fields:","source":"@site/docs/Services/USoft_Service_Definer_objects/Structures.md","sourceDirName":"Services/USoft_Service_Definer_objects","slug":"/Services/USoft_Service_Definer_objects/Structures","permalink":"/udocs/Services/USoft_Service_Definer_objects/Structures","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"Structures"},"sidebar":"sidebar","previous":{"title":"Services (Other)","permalink":"/udocs/Services/USoft_Service_Definer_objects/Services_Other"},"next":{"title":"Example: Custom authorization for REST services","permalink":"/udocs/Services/USoft_Service_Definer_objects/Example_Custom_authorization_for_REST_services"}}');var s=n(74848),i=n(28453);const a={id:"Structures"},o="Structures",c={},l=[{value:"Creating a structure",id:"creating-a-structure",level:2},{value:"Mapping between fields in a structure and XML and JSON messages",id:"mapping-between-fields-in-a-structure-and-xml-and-json-messages",level:2},{value:"Accepts attribute",id:"accepts-attribute",level:2},{value:"Produces attribute",id:"produces-attribute",level:2},{value:"Mapping between fields in a structure and SQL input or output columns",id:"mapping-between-fields-in-a-structure-and-sql-input-or-output-columns",level:2},{value:"Mapping between fields in a structure and SQL host variables",id:"mapping-between-fields-in-a-structure-and-sql-host-variables",level:2},{value:"Dealing with multiple rows (arrays)",id:"dealing-with-multiple-rows-arrays",level:2},{value:"Remodeling the XML structure of incoming and outgoing messages",id:"remodeling-the-xml-structure-of-incoming-and-outgoing-messages",level:2},{value:"Accessing data from a structure in the Implementation of a Method",id:"accessing-data-from-a-structure-in-the-implementation-of-a-method",level:2},{value:"Deriving structures from SQL statements or tables",id:"deriving-structures-from-sql-statements-or-tables",level:2}];function u(e){const t={admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"structures",children:"Structures"})}),"\n",(0,s.jsx)(t.p,{children:'A structure is, in functional terms, a named list of fields that correspond to data with specific format characteristics. For example, a structure called "CustomerDetails" could have the following fields:'}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Customer ID"}),"\n",(0,s.jsx)(t.li,{children:"Surname"}),"\n",(0,s.jsx)(t.li,{children:"First Name"}),"\n",(0,s.jsx)(t.li,{children:"Address"}),"\n",(0,s.jsx)(t.li,{children:"Country"}),"\n",(0,s.jsx)(t.li,{children:"Email address"}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"In technical terms, a structure is a helpful instrument for mapping output columns and host variables of a SQL statement executed by a REST method to formatting on the client side (that is, on the side of the caller of the service)."}),"\n",(0,s.jsx)(t.h2,{id:"creating-a-structure",children:"Creating a structure"}),"\n",(0,s.jsx)(t.p,{children:"The easiest way to create a structure is to have it derived from a SQL statement as part of generating a method implementation from SQL. You can also derive a structure from a SQL statement or from a table definition as a separate action."}),"\n",(0,s.jsx)(t.p,{children:"Finally, it is also possible to create a structure by defining all its aspects manually in the Structures window or tab. To do this, choose Define, Structures from the menu."}),"\n",(0,s.jsx)(t.h2,{id:"mapping-between-fields-in-a-structure-and-xml-and-json-messages",children:"Mapping between fields in a structure and XML and JSON messages"}),"\n",(0,s.jsx)(t.p,{children:"Structures in USoft Service Definer are used to easily consume and produce, in a REST service, both JSON and XML data formats. You can use the same structure to generate JSON or XML or both."}),"\n",(0,s.jsx)(t.h2,{id:"accepts-attribute",children:"Accepts attribute"}),"\n",(0,s.jsxs)(t.p,{children:["If a structure is specified as input parameter of a REST method, you can have the runtime Services Framework convert the XML or JSON format of the posted input data to fields in the structure. Do this by specifying, in Service Definer, one of the following media types as the value of the ",(0,s.jsx)(t.strong,{children:"Accepts"})," attribute of the method:"]}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{}),(0,s.jsx)(t.th,{})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"text/xml"}),(0,s.jsx)(t.td,{children:"XML request messages are accepted"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"application/json"}),(0,s.jsx)(t.td,{children:"JSON request messages are accepted"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"text/xml;application/json"}),(0,s.jsx)(t.td,{children:"Both XML and JSON request messages are accepted"})]})]})]}),"\n",(0,s.jsxs)(t.p,{children:["At runtime, the client specifies the actual format of the request message by setting the ",(0,s.jsx)(t.strong,{children:"Content-Type"})," HTTP header."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.strong,{children:"Accepts"})," attribute must be empty if the HTTP verb is GET. The default value for the Accepts attribute is 'text/xml'."]}),"\n",(0,s.jsx)(t.h2,{id:"produces-attribute",children:"Produces attribute"}),"\n",(0,s.jsx)(t.p,{children:"Likewise, if a structure is specified as return parameter of a REST method, you can have the runtime Services Platform pass the return data produced by the method as either XML or JSON. Do this by specifying, in Service Definer, one of the following media types as the value of the Produces attribute of the method:"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{}),(0,s.jsx)(t.th,{})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"text/xml"}),(0,s.jsx)(t.td,{children:"XML response messages are accepted"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"application/json"}),(0,s.jsx)(t.td,{children:"JSON response messages are accepted"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"text/xml;application/json"}),(0,s.jsx)(t.td,{children:"Both XML and JSON response messages are accepted"})]})]})]}),"\n",(0,s.jsxs)(t.p,{children:["At runtime, the client specifies the actual format of the reponse message by setting the ",(0,s.jsx)(t.strong,{children:"Accept"})," HTTP header."]}),"\n",(0,s.jsx)(t.p,{children:"The default value for the Produces attribute is 'text/xml'."}),"\n",(0,s.jsx)(t.h2,{id:"mapping-between-fields-in-a-structure-and-sql-input-or-output-columns",children:"Mapping between fields in a structure and SQL input or output columns"}),"\n",(0,s.jsx)(t.p,{children:"Structures in USoft Service Definer are also used to easily get or set the output or input of a SQL statement."}),"\n",(0,s.jsx)(t.p,{children:"At runtime, USoft will automatically fill the fields of a structure with the output of a SELECT statement if the field specifies a mapping to a output column in the SQL Statement. The mapping may be specified as Annotation of a field, using the syntax:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:'@Column(name="<label name>")\n'})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.em,{children:"Example"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:'@Column(name="RES_ID")\n'})}),"\n",(0,s.jsx)(t.p,{children:"This indicates that a field corresponds to an output column of a SQL Statement that has RES_ID as its column name or alias name."}),"\n",(0,s.jsx)(t.h2,{id:"mapping-between-fields-in-a-structure-and-sql-host-variables",children:"Mapping between fields in a structure and SQL host variables"}),"\n",(0,s.jsxs)(t.p,{children:["If a structure is specified as input parameter of a REST method, you can have the runtime Services Framework automatically setting host variables in a SQL Statement to incoming data values. Do this by setting the Annotation attribute of the field using the syntax ",(0,s.jsx)(t.strong,{children:'@Column(name="<host variable name>")'}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["In this scenario,you do not need to create structures by manual coding. The necessary structures are automatically created when you generate a REST method from the SQL statement. In the SQL statement, the name of the structure is used in the host variable. The syntax is ",(0,s.jsx)(t.strong,{children:":<structure name>.<field name>"}),"."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.em,{children:"Example"})}),"\n",(0,s.jsx)(t.p,{children:"In this SQL statement, the name of the structure is 'MyPersonNameStructure':"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sql",children:"UPDATE \xa0 \xa0person\nSET \xa0 \xa0 \xa0 (\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0first_name\n, \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 family_name\n) =\n( \xa0 \xa0SELECT \xa0 \xa0:MyPersonNameStructure.FirstName\n, \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 :MyPersonNameStructure.SurName\n)\nWHERE \xa0 \xa0 person_id = :id\n\n"})}),"\n",(0,s.jsxs)(t.p,{children:["The input parameter '",":id","' in the WHERE clause is of a different type than the host variables in the SET clause. This input parameter is passed at runtime as part of the request URL of the REST service."]}),"\n",(0,s.jsx)(t.p,{children:"In this example, the structure is used as follows in the Implementation of the method:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:'Integer result = (Integer)sql( "UPDATE_PERSON" , new Object[]{ objMyPersonNameStructure, id } );\n\n'})}),"\n",(0,s.jsx)(t.p,{children:"where UPDATE_PERSON is the name of the SQL statement."}),"\n",(0,s.jsx)(t.h2,{id:"dealing-with-multiple-rows-arrays",children:"Dealing with multiple rows (arrays)"}),"\n",(0,s.jsxs)(t.p,{children:["If the output of a SQL statement has multiple rows you can use arrays of structures to receive all rows. The syntax is: ",(0,s.jsx)(t.strong,{children:"MyReservationStructure[]"}),", where ",(0,s.jsx)(t.strong,{children:"MyReservationStructure"})," is the name of the structure. For example, you can write as the Implementation of a method:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:'MyReservationStructure[] \xa0reservations = ( MyReservationStructure[])sql( MyReservationStructure[].class, "GET_CURRENT_BOOKINGS" \xa0);\n\n'})}),"\n",(0,s.jsxs)(t.p,{children:["If the output or input of a REST Service contains has a list of elements held in an XML or JSON array, you can use the same syntax ",(0,s.jsx)(t.strong,{children:"MyReservationStructure[]"})," in the Type field of the Parameter. Such a list of elements could look like this in XML:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-xml",children:'<MyReservationStructures>\n \xa0 \xa0<MyReservationStructure participants="1" id="160">\n \xa0 \xa0 \xa0 \xa0<destination>AUSTRALIA</destination>\n \xa0 \xa0 \xa0 \xa0<tour>53</tour> \xa0 \xa0 \xa0 \xa0\n        <type>ISLAND SUNTANNER</type>\n \xa0 \xa0</MyReservationStructure>\n \xa0 \xa0<MyReservationStructure participants="3" id="157">\n \xa0 \xa0 \xa0 \xa0<destination>AUSTRALIA</destination>\n \xa0 \xa0 \xa0 \xa0<tour>54</tour>\n \xa0 \xa0 \xa0 \xa0<type>ISLAND SUNTANNER</type>\n \xa0 \xa0</MyReservationStructure>\n \xa0 \xa0<MyReservationStructure participants="1" id="182">\n \xa0 \xa0 \xa0 \xa0<destination>BRAZIL</destination>\n \xa0 \xa0 \xa0 \xa0<tour>144</tour>\n \xa0 \xa0 \xa0 \xa0<type>RAINFOREST RIDE</type>\n \xa0 \xa0</MyReservationStructure>\n</MyReservationStructures>\n\n'})}),"\n",(0,s.jsx)(t.p,{children:"Or it could look like this in JSON:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-language-json",children:'[\n    {\n        "participants": 1,\n        "id": 160,\n        "destination": "AUSTRALIA",\n        "tour": 53,\n        "type": "ISLAND SUNTANNER"\n    },\n    {\n        "participants": 3,\n        "id": 157,\n        "destination": "AUSTRALIA",\n        "tour": 54,\n        "type": "ISLAND SUNTANNER"\n    },\n    {\n        "participants": 1,\n        "id": 182,\n        "destination": "BRAZIL",\n        "tour": 144,\n        "type": "RAINFOREST RIDE"\n    }\n]\n'})}),"\n",(0,s.jsx)(t.h2,{id:"remodeling-the-xml-structure-of-incoming-and-outgoing-messages",children:"Remodeling the XML structure of incoming and outgoing messages"}),"\n",(0,s.jsx)(t.p,{children:"Using annotations, you can map data in incoming and outgoing XML messages variously to XML elements or to XML attributes:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["To specify that a field of a structure maps to an element in the XML structure, specify ",(0,s.jsx)(t.strong,{children:'@XmlElement(name="<xml element name>")'})," as Annotation for the field."]}),"\n",(0,s.jsxs)(t.li,{children:["To specify that a field of a structure maps to an attribute in the XML structure, specify ",(0,s.jsx)(t.strong,{children:'@XmlAttribute(name="<attribute name>")'})," as Annotation for the field."]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.em,{children:"Example"})}),"\n",(0,s.jsxs)(t.p,{children:["You have a REST service that produces the following XML response message on the basis of a structure named ",(0,s.jsx)(t.strong,{children:"MyPersonStructure"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-xml",children:"<MyPersonStructure>\n \xa0<PERSON_ID>137</PERSON_ID>\n \xa0<FIRST_NAME>Johnny</FIRST_NAME>\n \xa0<FAMILY_NAME>LOGAN</FAMILY_NAME>\n</MyPersonStructure>\n\n"})}),"\n",(0,s.jsx)(t.p,{children:"You want this output to look like this:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-xml",children:'<Client ID="137">\n \xa0<FirstName>Johnny</FirstName>\n \xa0<Surname>LOGAN</Surname>\n</Client>\n\n'})}),"\n",(0,s.jsx)(t.p,{children:"To achieve this, follow these steps:"}),"\n",(0,s.jsx)(t.p,{children:'1.\xa0Change the annotation for the structure from @Entity;@XmlRootElement(name="MyPersonStructure") to:'}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:'@Entity;@XmlRootElement(name="Client")\n'})}),"\n",(0,s.jsx)(t.p,{children:'2.\xa0Change the annotation for the PERSON_ID field from @Column(name="PERSON_ID");@XmlElement(name="PERSON_ID") to:'}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:'@Column(name="PERSON_ID");@XmlAttribute(name="ID")\n'})}),"\n",(0,s.jsxs)(t.p,{children:["Note in particular that ",(0,s.jsx)(t.strong,{children:"@XmlElement"})," was replaced by ",(0,s.jsx)(t.strong,{children:"@XmlAttribute"}),"."]}),"\n",(0,s.jsx)(t.p,{children:'3.\xa0Change the annotation for the FIRST_NAME field from @Column(name="FIRST_NAME");@XmlElement(name="FIRST_NAME") to:'}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:'@Column(name="FIRST_NAME");@XmlElement(name="FirstName")\n'})}),"\n",(0,s.jsx)(t.p,{children:'4.\xa0Change the annotation for the FAMILY_NAME field from @Column(name="FAMILY_NAME");@XmlElement(name="FAMILY_NAME") to:'}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:'@Column(name="FAMILY_NAME");@XmlElement(name="Surname")\n'})}),"\n",(0,s.jsx)(t.h2,{id:"accessing-data-from-a-structure-in-the-implementation-of-a-method",children:"Accessing data from a structure in the Implementation of a Method"}),"\n",(0,s.jsx)(t.p,{children:'In the Implementation code of a method, you can access data from a structure, for example (for a structure named "MyBookingStructure"):'}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:'Reservation\xa0reservation =\xa0(Reservation)sql(\xa0 \xa0Reservation.class,\xa0"MyBookingStructure", new\xa0Object[]{\xa0id\xa0}\xa0 );\n\n'})}),"\n",(0,s.jsx)(t.p,{children:"and then use that data in a subsequent sql() function in that same Implementation code, for example:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:'CountryHighlights[] highlights =\xa0(CountryHighlights[])sql(\xa0 \xa0CountryHighlights[].class,\xa0"GET_COUNTRY_HIGHLIGHTS", new\xa0Object[]{\xa0reservation.destination\xa0}\xa0 );\n\n'})}),"\n",(0,s.jsx)(t.h2,{id:"deriving-structures-from-sql-statements-or-tables",children:"Deriving structures from SQL statements or tables"}),"\n",(0,s.jsx)(t.p,{children:"You can derive a structure from an existing SQL statement (defined in USoft Service Definer) or from an existing table definition (defined in USoft Definer)."}),"\n",(0,s.jsx)(t.p,{children:"This is useful when you want to create a method implementation programmatically (ie., by manual coding in Java) and you need a definition of the field names and datatypes of the return data structure."}),"\n",(0,s.jsx)(t.admonition,{type:"danger",children:(0,s.jsx)(t.p,{children:"When you generate a method implementation from a SQL statement, USoft Service Definer will create the entire method implementation including a structure derived from the statement. If you work in this way, you do NOT need to derive a structure as a separate action."})}),"\n",(0,s.jsx)(t.p,{children:"To derive a structure from a statement or table definition:"}),"\n",(0,s.jsx)(t.p,{children:"1.\xa0Choose Tools, Derive Structure from the menu."}),"\n",(0,s.jsx)(t.p,{children:"2.\xa0In the Derive Structure dialog, specify the Return Structure Name that you want for the structure."}),"\n",(0,s.jsx)(t.p,{children:"3.\xa0If you want to derive the structure from a SQL statement, select 'Derive Structure from SQL Statement' and specify an existing SQL statement name. You can use the lookup button to select such a name from a list."}),"\n",(0,s.jsx)(t.p,{children:"4.\xa0If you want to derive the structure from a table definition, select 'Derive Structure from Table', specify the application that the table is part of (you can use the lookup button to select an existing application name), and type the table name."}),"\n",(0,s.jsx)(t.p,{children:"5.\xa0Click OK."}),"\n",(0,s.jsx)(t.p,{children:"The structure is now derived. You can find it under Structures in the Catalog on the left-hand side, or by retrieving it in the Structures window or tab (choose Define, Structures from the menu)."})]})}function d(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>o});var r=n(96540);const s={},i=r.createContext(s);function a(e){const t=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(i.Provider,{value:t},e.children)}}}]);