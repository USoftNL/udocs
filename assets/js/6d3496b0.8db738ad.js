"use strict";(self.webpackChunkudocs=self.webpackChunkudocs||[]).push([[17647],{28453:(e,n,o)=>{o.d(n,{R:()=>s,x:()=>i});var t=o(96540);const a={},c=t.createContext(a);function s(e){const n=t.useContext(c);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),t.createElement(c.Provider,{value:n},e.children)}},72728:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>r,frontMatter:()=>s,metadata:()=>t,toc:()=>p});const t=JSON.parse('{"id":"Modeller_and_Rules_Engine/RDBMS_and_data_connectivity/MTS_Example_2_component_sample_code","title":"MTS Example 2: component sample code","description":"The sample code below shows what an MTS component usually looks like. To make a connection, ADO is used, but you can also use the OLE-DB or the ODBC API. You should use these APIs as for a normal connection to a database. The \'Commit\' or \'Rollback\' call must be replaced by the SetComplete or SetAbort call of the context object. The code of the Bank Sample application components is also provided with the Sample Bank application. You can use this to obtain more details.","source":"@site/docs/Modeller_and_Rules_Engine/RDBMS_and_data_connectivity/MTS_Example_2_component_sample_code.md","sourceDirName":"Modeller_and_Rules_Engine/RDBMS_and_data_connectivity","slug":"/Modeller_and_Rules_Engine/RDBMS_and_data_connectivity/MTS_Example_2_component_sample_code","permalink":"/udocs/Modeller_and_Rules_Engine/RDBMS_and_data_connectivity/MTS_Example_2_component_sample_code","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"MTS_Example_2_component_sample_code"},"sidebar":"sidebar","previous":{"title":"MTS Example 1: The Bank Sample application","permalink":"/udocs/Modeller_and_Rules_Engine/RDBMS_and_data_connectivity/MTS_Example_1_The_Bank_Sample_application"},"next":{"title":"Localising your application","permalink":"/udocs/Modeller_and_Rules_Engine/Localising_your_application"}}');var a=o(74848),c=o(28453);const s={id:"MTS_Example_2_component_sample_code"},i="MTS Example 2: component sample code",l={},p=[];function d(e){const n={code:"code",h1:"h1",header:"header",p:"p",pre:"pre",...(0,c.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"mts-example-2-component-sample-code",children:"MTS Example 2: component sample code"})}),"\n",(0,a.jsx)(n.p,{children:"The sample code below shows what an MTS component usually looks like. To make a connection, ADO is used, but you can also use the OLE-DB or the ODBC API. You should use these APIs as for a normal connection to a database. The 'Commit' or 'Rollback' call must be replaced by the SetComplete or SetAbort call of the context object. The code of the Bank Sample application components is also provided with the Sample Bank application. You can use this to obtain more details."}),"\n",(0,a.jsx)(n.p,{children:"Here is the code of a simple component that inserts an amount of money in an account in the Bank Sample Application. It is written with ADO."}),"\n",(0,a.jsx)(n.p,{children:"Component::Insert(int account_no, int amount)"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'{\n \xa0 \xa0ADOConnection* adoCoConnection = NULL;\n \xa0 \xa0String statement = "UPDATE Account SET Balance = Balance "+ amount +\n"WHERE AccountNo = " + account_no;\n \xa0 \xa0IObjectContext *ObjectContext = NULL;\n \xa0 \xa0// Get the Context Object from your component. (This is not needed if you use COM+).\nGetObjectContext(&ObjectContext);\n \xa0 \xa0// Create an ADO Connection object\n \xa0 \xa0CoCreateInstance (CLSID_CADOConnection,\nNULL,\nCLSCTX_INPROC_SERVER,\nIID_IADOConnection,\n(LPVOID *) &adoCoConnection);\n \xa0 \xa0// Open a connection to a Rules Engine\nadoCoConnection->Open ("Your connection String", NULL, NULL, -1);\n \xa0 // Execute the statement\n \xa0 \xa0adoCoConnection->Execute(statement, NULL , -1, NULL);\n \xa0 // Resource cleanup \xa0 \xa0\n \xa0 \xa0if (adoCoConnection) adoCoConnection->Release();\n \xa0 // Finish\n \xa0 \xa0ObjectContext->SetComplete();\n}\n\n'})})]})}function r(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}}}]);