"use strict";(self.webpackChunkudocs=self.webpackChunkudocs||[]).push([[93769],{28453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>r});var o=n(96540);const i={},a=o.createContext(i);function s(e){const t=o.useContext(a);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),o.createElement(a.Provider,{value:t},e.children)}},51167:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/f42a3b8e-2878-47e8-9e80-4e14c23b4fa2-f5353471c0052155f31665f7106b8686.jpg"},74537:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"Modeller_and_Rules_Engine/RDBMS_and_data_connectivity/Microsoft_Transaction_Server_MTS","title":"Microsoft Transaction Server (MTS)","description":"Microsoft Transaction Server (MTS) is a component-based transaction processing system for building, deploying, and administering Internet and Intranet server applications. The MTS programming model provides a transaction coordination framework for developing components that encapsulate business logic. In Windows XP, MTS and Microsoft\'s Component Object Model (COM) are unified in COM+.","source":"@site/docs/Modeller_and_Rules_Engine/RDBMS_and_data_connectivity/Microsoft_Transaction_Server_MTS.md","sourceDirName":"Modeller_and_Rules_Engine/RDBMS_and_data_connectivity","slug":"/Modeller_and_Rules_Engine/RDBMS_and_data_connectivity/Microsoft_Transaction_Server_MTS","permalink":"/udocs/Modeller_and_Rules_Engine/RDBMS_and_data_connectivity/Microsoft_Transaction_Server_MTS","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"Microsoft_Transaction_Server_MTS"},"sidebar":"sidebar","previous":{"title":"USoft as a DDE server","permalink":"/udocs/Modeller_and_Rules_Engine/RDBMS_and_data_connectivity/USoft_as_a_DDE_server"},"next":{"title":"MTS Example 1: The Bank Sample application","permalink":"/udocs/Modeller_and_Rules_Engine/RDBMS_and_data_connectivity/MTS_Example_1_The_Bank_Sample_application"}}');var i=n(74848),a=n(28453);const s={id:"Microsoft_Transaction_Server_MTS"},r="Microsoft Transaction Server (MTS)",c={},d=[{value:"Distributed transactions and the two-phase commit protocol",id:"distributed-transactions-and-the-two-phase-commit-protocol",level:2},{value:"The MTS architecture",id:"the-mts-architecture",level:2}];function l(e){const t={h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"microsoft-transaction-server-mts",children:"Microsoft Transaction Server (MTS)"})}),"\n",(0,i.jsx)(t.p,{children:"Microsoft Transaction Server (MTS) is a component-based transaction processing system for building, deploying, and administering Internet and Intranet server applications. The MTS programming model provides a transaction coordination framework for developing components that encapsulate business logic. In Windows XP, MTS and Microsoft's Component Object Model (COM) are unified in COM+."}),"\n",(0,i.jsx)(t.p,{children:"USoft applications can be integrated with the Microsoft Transaction Server (MTS) architecture to support distributed transactions. A USoft application and MTS components can be involved in distributed, 'global' transactions. One of the main advantages is that these distributed transactions benefit from the two-phase commit protocol."}),"\n",(0,i.jsx)(t.p,{children:"Requirements"}),"\n",(0,i.jsx)(t.p,{children:"To be able to integrate USoft Developer with MTS, you need:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"MTS version 2.0"}),"\n",(0,i.jsx)(t.li,{children:"MS SQL Server version 7.0 or Oracle version 7.3.4 or higher"}),"\n",(0,i.jsx)(t.li,{children:"Microsoft ODBC Manager version 3.51."}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"For more information about MTS, including the exact database requirements, please refer to the Microsoft Transaction Server Reference supplied with MTS."}),"\n",(0,i.jsx)(t.h2,{id:"distributed-transactions-and-the-two-phase-commit-protocol",children:"Distributed transactions and the two-phase commit protocol"}),"\n",(0,i.jsx)(t.p,{children:"A distributed transaction is a transaction that consists of data manipulations made on one or several databases, using one or more database connections. A non-distributed transaction is a transaction that consists of data manipulations made on only one database, using only one database connection (which is the case for the two-tier USoft client/server architecture). The MTS architecture supports distributed transactions: a transaction can consist of data manipulations made by several components on several databases."}),"\n",(0,i.jsx)(t.p,{children:"Distributed transactions benefit from the two-phase commit protocol. This protocol provides a standard way of handling distributed transactions. MTS also uses this two-phase commit protocol."}),"\n",(0,i.jsx)(t.p,{children:"When the two-phase commit protocol is used for a distributed transaction, the transaction will only be committed if ALL manipulations made by Rules Engines and MTS components involved in that transaction, on the same or different databases, are successfully committed. If one of the components fails to commit, the whole transaction is aborted and a rollback occurs."}),"\n",(0,i.jsx)(t.h2,{id:"the-mts-architecture",children:"The MTS architecture"}),"\n",(0,i.jsx)(t.p,{children:"In the new architecture, an MTS component connects to the Rules Engine via the Remote Rules Service. The Rules Engine acts here as a server."}),"\n",(0,i.jsx)(t.p,{children:"MTS components are COM-components that can be involved in distributed transactions. These components can be written with Visual Basic, C++ or any language that is adapted to write COM components."}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{src:n(51167).A+"",width:"349",height:"364"})}),"\n",(0,i.jsx)(t.p,{children:"\xa0"}),"\n",(0,i.jsx)(t.p,{children:"Architecture combining MTS Components and the Rules Engine"}),"\n",(0,i.jsx)(t.p,{children:"\xa0"}),"\n",(0,i.jsx)(t.p,{children:"To connect to the Rules Engine, an MTS component uses an ODBC Data source. This data source must have been set up for the Remote Rules Service. You must use one of the following API's: ODBC, OLE-DB, ADO, or JDBC. Refer to the USoft Remote Rules Service API Help for more information on these subjects."}),"\n",(0,i.jsx)(t.p,{children:"Within the MTS architecture, the Rules Engine appears as a database connected via the Remote Rules Service API. The actual database, however, is the RDBMS that the Rules Engine connects to. Therefore, the Rules Engine must tell MTS that this RDBMS also participates in the distributed transaction. To allow the RDBMS to participate in the distributed transaction, the Rules Engine needs to: connect to the RDBMS either with an ODBC connection, or with an MS SQL Server connection."}),"\n",(0,i.jsx)(t.p,{children:"If you want to connect, for example, to an Oracle database, you must use an ODBC for Oracle driver that supports MTS. This driver is delivered by Microsoft with the installation of MTS. Please refer to your MTS documentation for details."}),"\n",(0,i.jsx)(t.p,{children:"To improve performance:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Set the connection pooling for the USoft Remote Rules Service API to ON."}),"\n",(0,i.jsx)(t.li,{children:"Set the timeout to 600."}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"Without connection pooling, a Rules Engine will be created for each new database connection. This takes quite a long time. With connection pooling turned on, after a component releases its Rules Engine connection, this connection can be re-used for another component."}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Restriction:"})," With distributed transactions, the Rules Engine cannot handle deferred constraints directly."]}),"\n",(0,i.jsx)(t.p,{children:"\xa0"})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}}}]);