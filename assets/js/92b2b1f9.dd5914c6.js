"use strict";(self.webpackChunkudocs=self.webpackChunkudocs||[]).push([[77834],{28453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>a});var t=r(96540);const s={},i=t.createContext(s);function o(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(i.Provider,{value:n},e.children)}},29439:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>o,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"Services/Custom_REST_services/Defining_custom_REST_error_handling","title":"Defining custom REST error handling","description":"By default, when a USoft Rules Engine raises an error this result in an error message that expresses the business rule enforced by the Rules Engine.","source":"@site/docs/Services/Custom_REST_services/Defining_custom_REST_error_handling.md","sourceDirName":"Services/Custom_REST_services","slug":"/Services/Custom_REST_services/Defining_custom_REST_error_handling","permalink":"/udocs/Services/Custom_REST_services/Defining_custom_REST_error_handling","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"Defining_custom_REST_error_handling"},"sidebar":"sidebar","previous":{"title":"Defining custom REST response messages","permalink":"/udocs/Services/Custom_REST_services/Defining_custom_REST_response_messages"},"next":{"title":"Limiting the number of records returned by a REST service","permalink":"/udocs/Services/Custom_REST_services/Limiting_the_number_of_records_returned_by_a_REST_service"}}');var s=r(74848),i=r(28453);const o={id:"Defining_custom_REST_error_handling"},a="Defining custom REST error handling",c={},l=[{value:"Step 1: Add an application-specific error mapper to the server",id:"step-1-add-an-application-specific-error-mapper-to-the-server",level:2},{value:"",id:"",level:3},{value:"Step 2: Provide a custom implementation",id:"step-2-provide-a-custom-implementation",level:2}];function h(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"defining-custom-rest-error-handling",children:"Defining custom REST error handling"})}),"\n",(0,s.jsx)(n.p,{children:"By default, when a USoft Rules Engine raises an error this result in an error message that expresses the business rule enforced by the Rules Engine."}),"\n",(0,s.jsx)(n.p,{children:"For this reason, it can happen that a REST user who attempts to make a new booking is confronted with the internal business rule formulation:"}),"\n",(0,s.jsx)(n.p,{children:'"Scheduled Tour 50 may not be overbooked by more than 20 %".'}),"\n",(0,s.jsx)(n.p,{children:"In a REST setting this is often undesirable. The business rule is often confidential, not customer-oriented, or too technical."}),"\n",(0,s.jsx)(n.p,{children:'Default error handling may be overruled for REST services by providing an application-specific error mapper class. A default example of an error mapper class is provided by USoft as application data. It is offered as a Functional Type called "REST error handling" in USoft Service Definer. There is also an initial example REST service called "AppExceptionMapper" that uses this Functional Type.'}),"\n",(0,s.jsx)(n.p,{children:"In USoft applications, all messages are initially formatted in XML. This XML message is available in REST interfaces for processing. This way you can change (for example) the text of an error message that a constraint provides."}),"\n",(0,s.jsx)(n.p,{children:"The following 2 steps are needed to provide a custom error handling."}),"\n",(0,s.jsx)(n.h2,{id:"step-1-add-an-application-specific-error-mapper-to-the-server",children:"Step 1: Add an application-specific error mapper to the server"}),"\n",(0,s.jsx)(n.p,{children:"To add an application-specific error mapper to the server:"}),"\n",(0,s.jsx)(n.p,{children:"1.\xa0From the Catalog, open the AppExceptionMapper example REST Service."}),"\n",(0,s.jsx)(n.p,{children:'2.\xa0Make sure that a server called "Default" is declared on the Servers tab.'}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"At this point all the errors will be handled by the toResponse method of the AppExceptionMapper. Take some time to understand the default implementation provided by USoft."})}),"\n",(0,s.jsx)(n.p,{children:'3.\xa0Open the record for the REST Service that will raise the error(s), and change the log level to "Information".'}),"\n",(0,s.jsx)(n.p,{children:"4.\xa0Stop the server, Publish the service, then Start the server again."}),"\n",(0,s.jsx)(n.p,{children:"5.\xa0On the REST client, execute the same data manipulation as before you added error handling."}),"\n",(0,s.jsx)(n.p,{children:"6.\xa0In File Explorer, go to the Server Publication file path and search for the log file."}),"\n",(0,s.jsx)(n.p,{children:"7.\xa0Open the log file and search for the error in XML format. Check that the error has a message tag with constraint-name = (the constraint in the USoft Rules Engine that has the business rule as its Message), for example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'constraint-name="OVERBOOKING_LIMIT"\n'})}),"\n",(0,s.jsx)(n.p,{children:"and that the error has"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'source="constraint"\n'})}),"\n",(0,s.jsx)(n.h3,{id:"",children:"\xa0"}),"\n",(0,s.jsx)(n.h2,{id:"step-2-provide-a-custom-implementation",children:"Step 2: Provide a custom implementation"}),"\n",(0,s.jsx)(n.p,{children:'You are now ready to change the Implementation of the AppExceptionMapper. Look in the XML error message if the source of the error is "constraint", and if so, whether that constraint is the OVERBOOKING_LIMIT constraint:'}),"\n",(0,s.jsx)(n.p,{children:"1.\xa0Open AppExceptionMapper."}),"\n",(0,s.jsx)(n.p,{children:"2.\xa0Go to the Implementation of the toResponse method."}),"\n",(0,s.jsx)(n.p,{children:"3.\xa0Replace the line:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'org.w3c.dom.NodeList list = XMLUtil.getNodes(d, "//uslng:message");\n'})}),"\n",(0,s.jsx)(n.p,{children:"by:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"org.w3c.dom.NodeList list = XMLUtil.getNodes(d, \"//uslng:message[@source='constraint' and @constraint-name='OVERBOOKING_LIMIT']\");\n"})}),"\n",(0,s.jsx)(n.p,{children:'4.\xa0Change the text \u201cerror message here\u201d with a message that is more suitable for the REST user, for example "There are no more places available on this trip". (Even this is a fallback message; correct application design is probably to avoid offering unavailable product in the first place.)'}),"\n",(0,s.jsx)(n.p,{children:'5.\xa0Publish and restart the "Default" server.'}),"\n",(0,s.jsx)(n.p,{children:"6.\xa0On the REST client, repeat the previous manipulation and see that the error message has changed."})]})}function d(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}}}]);