"use strict";(self.webpackChunkudocs=self.webpackChunkudocs||[]).push([[2812],{19151:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"Modeller_and_Rules_Engine/Constraints_advanced_and_the_Rules_Engine/Cascadetoother_corrections","title":"Cascade-to-other corrections","description":"Cascade-to-other corrections are corrections of column values in one or more records that are different from the record being processed. These may be different records in the same table instance, records in a different table instance of the same table, or records in a different table altogether.","source":"@site/docs/Modeller_and_Rules_Engine/Constraints_advanced_and_the_Rules_Engine/Cascadetoother_corrections.md","sourceDirName":"Modeller_and_Rules_Engine/Constraints_advanced_and_the_Rules_Engine","slug":"/Modeller_and_Rules_Engine/Constraints_advanced_and_the_Rules_Engine/Cascadetoother_corrections","permalink":"/udocs/Modeller_and_Rules_Engine/Constraints_advanced_and_the_Rules_Engine/Cascadetoother_corrections","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"Cascadetoother_corrections"},"sidebar":"sidebar","previous":{"title":"Transaction checks","permalink":"/udocs/Modeller_and_Rules_Engine/Constraints_advanced_and_the_Rules_Engine/Transaction_checks"},"next":{"title":"Driving table","permalink":"/udocs/Modeller_and_Rules_Engine/Constraints_advanced_and_the_Rules_Engine/Driving_table"}}');var o=n(74848),s=n(28453);const i={id:"Cascadetoother_corrections"},a="Cascade-to-other corrections",c={},d=[{value:"Effect of cascade-to-other corrections",id:"effect-of-cascade-to-other-corrections",level:2}];function l(e){const t={code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"cascade-to-other-corrections",children:"Cascade-to-other corrections"})}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Cascade-to-other corrections"})," are corrections of column values in one or more records that are ",(0,o.jsx)(t.em,{children:"different"})," from the record being processed. These may be different records in the same table instance, records in a different table instance of the same table, or records in a different table altogether."]}),"\n",(0,o.jsx)(t.p,{children:"Cascade-to-other corrections are performed at record-store time, after any row checks applied to the record being processed, and after this record is actually stored internally. This is also expressed by saying that cascade-to-other corrections occur in the post-store phase of a store-record event."}),"\n",(0,o.jsx)(t.p,{children:"A productive multi-record constraint is evaluated as a cascade-to-other correction if it meets both of the following conditions:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"The constraint cannot be evaluated as an update-on-self correction."}),"\n",(0,o.jsx)(t.li,{children:"The constraint is not deferred to the next transition (= does not have Deferred = Post Commit)."}),"\n"]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.em,{children:"Example"})}),"\n",(0,o.jsx)(t.p,{children:'A business rule "The price of a reservation is the price of the scheduled tour multiplied by the number of participants in the reservation. Personal discount and group discount percentages may apply. If both apply, only the higher percentage is deduced." is implemented by a productive constraint:'}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"UPDATE \xa0 \xa0reservation r\nSET \xa0 \xa0 \xa0 r.price =\n(\n \xa0 \xa0SELECT \xa0 \xa0s.price * COUNT( pt.person_id ) *\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0(( 100 \u2013 GREATEST( r.person_discount, r.group_discount )) / 100 )\n \xa0 \xa0FROM \xa0 \xa0 \xa0schedtour s\n \xa0 \xa0, \xa0 \xa0 \xa0 \xa0 participant pt\n \xa0 \xa0WHERE \xa0 \xa0 s.schedtour_id = r.schedtour_id\n \xa0 \xa0AND \xa0 \xa0 \xa0 r.res_id = pt.res_id\n \xa0 \xa0GROUP BY \xa0s.price\n \xa0 \xa0, \xa0 \xa0 \xa0 \xa0 r.person_discount\n \xa0 \xa0, \xa0 \xa0 \xa0 \xa0 r.group_discount\n)\n"})}),"\n",(0,o.jsx)(t.p,{children:"This price calculation constraint is non-transitional. It will be evaluated as soon as any of the columns mentioned in the constraint SQL is manipulated."}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:["If it is evaluated as a result of a PARTICIPANT record being added to or deleted from \xa0the reservation, the constraint is handled as a ",(0,o.jsx)(t.strong,{children:"cascade-to-other correction"})," because the two adjustments required (the addition or deletion of the participant in PARTICIPANT, and the price re-calculation in RESERVATION) are not within the record being processed."]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:["If it is evaluated as a result of a SCHEDTOUR price being changed, the constraint is handled as a ",(0,o.jsx)(t.strong,{children:"cascade-to-other correction"})," because the two adjustments required (the price change in SCHEDTOUR, and the price re-calculation in RESERVATION) are not within the record being processed."]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:["If it is evaluated as a result of one of the RESERVATION columns being modified, the constraint is handled as an ",(0,o.jsx)(t.strong,{children:"update-on-self correction"}),". This is because in this case, the two adjustments required (the update of the SCHEDTOUR_ID column value and the update of the PRICE column value) are both within the record being processed. This applies, for instance, if the scheduled tour of an existing reservation is changed. As a result of this update, the price must be re-calculated."]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(t.h2,{id:"effect-of-cascade-to-other-corrections",children:"Effect of cascade-to-other corrections"}),"\n",(0,o.jsx)(t.p,{children:"If an evaluated cascade-to-other correction has an effect, this effect is to manipulate one or more records other than the record being processed. For each of these records, this effect is that a new record-store event occurs."}),"\n",(0,o.jsx)(t.p,{children:"A cascade-to-other correction may recursively trigger any number of further corrections until all the application data satisfies the conditions defined in the table constraints or the maximum constraint depth limit is reached."}),"\n",(0,o.jsx)(t.p,{children:"\xa0"})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>a});var r=n(96540);const o={},s=r.createContext(o);function i(e){const t=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),r.createElement(s.Provider,{value:t},e.children)}}}]);